create or replace PACKAGE IAL_CVW.pkg_custody
/*#################################################*/
/*            cr_pkg_custody_pkg.sql               */
/*-------------------------------------------------*/
/* SPS : 06-JUL-18 - creation                      */
/*#################################################*/

AS

/*-------------------------------*/
/* ##### GLOBAL VARIABLES  ##### */
/*-------------------------------*/

/*-------------------------------*/
/* ##### FUNCTIONS : Begin ##### */
/*-------------------------------*/

FUNCTION sf_get_SecurityId
   (inSscSecId                  IN     IAL_OIR.security_master.ssc_sec_id%TYPE)  RETURN NUMBER;

/*-------------------------------*/
/* ##### FUNCTIONS :  End  ##### */
/*-------------------------------*/

/*--------------------------------*/
/* ##### PROCEDURES : Begin ##### */
/*--------------------------------*/

PROCEDURE sp_Custody_Trans_01
   (inSourceCorrId              IN     message_cvw.source_corr_id%TYPE,
    inMsgType                   IN     message_cvw.msg_type%TYPE,
    inMsgSubType                IN     message_cvw.msg_sub_type%TYPE,
    inSrcSstm                   IN     message_cvw.src_sstm%TYPE,
    inDstntnSstm                IN     message_cvw.dstntn_sstm%TYPE,
    inMsgState                  IN     message_cvw.msg_state%TYPE,
    inQueueName                 IN     message_cvw.queue_name%TYPE,
    inMsgSendDttm               IN     message_cvw.msg_send_dttm%TYPE,
    inMsgRcvdDttm               IN     message_cvw.msg_rcvd_dttm%TYPE,
    inMsgVrsnNmbr               IN     message_cvw.msg_vrsn_nmbr%TYPE,
    inMsgTmstmp                 IN     message_cvw.msg_tmstmp%TYPE,
    inMsgClob                   IN     message_cvw.msg_clob%TYPE,
    inReplayFlg                 IN     message_cvw.replay_flg%TYPE,
    inReplayLgn                 IN     message_cvw.replay_lgn%TYPE,
    inReplayMsgId               IN     message_cvw.replay_msg_id%TYPE,
    inRefMsgId                  IN     message_cvw.ref_msg_id%TYPE,
    inUpdtLgn                   IN     message_cvw.updt_lgn%TYPE,
    inUpdtDttm                  IN     message_cvw.updt_dttm%TYPE,
    outMsgId                       OUT message_cvw.msg_id%TYPE);

PROCEDURE sp_Custody_Trans_02
   (inPosFund                   IN     gsmac_position.pos_fund%TYPE,
    inPosSetlLoc                IN     gsmac_position.pos_setl_loc%TYPE,
    inPosCusip                  IN     gsmac_position.pos_cusip%TYPE,
    inActTrdId                  IN     gsmac_position_history.act_trd_id%TYPE,  -- History table ONLY
    inSourceCorrId              IN     gsmac_position.source_corr_id%TYPE,
    inMsgId                     IN     gsmac_position.msg_id%TYPE,
    inMsgSrc                    IN     gsmac_position.msg_src%TYPE,
    inPosMatDt                  IN     gsmac_position.pos_mat_dt%TYPE,
    inPosRate                   IN     gsmac_position.pos_rate%TYPE,
    inPosSetlLocName            IN     gsmac_position.pos_setl_loc_name%TYPE,
    inPosFundName               IN     gsmac_position.pos_fund_name%TYPE,
    inPosAssetDesc              IN     gsmac_position.pos_asset_desc%TYPE,
    inAsofTradeDt               IN     gsmac_position.asof_trade_dt%TYPE,
    inAsofCsd                   IN     gsmac_position.asof_csd%TYPE,
    inAsofSafe                  IN     gsmac_position.asof_safe%TYPE,
    inAsofAvail                 IN     gsmac_position.asof_avail%TYPE,
    inAsofOutForReg             IN     gsmac_position.asof_out_for_reg%TYPE,
    inAsofReg                   IN     gsmac_position.asof_reg%TYPE,
    inAsofUnregOth              IN     gsmac_position.asof_unreg_oth%TYPE,
    inAsofUnregVol              IN     gsmac_position.asof_unreg_vol%TYPE,
    inAsofSsbBor                IN     gsmac_position.asof_ssb_bor%TYPE,
    inAsof3ptyBor               IN     gsmac_position.asof_3pty_bor%TYPE,
    inAsofSsbLoan               IN     gsmac_position.asof_ssb_loan%TYPE,
    inAsof3ptyLoan              IN     gsmac_position.asof_3pty_loan%TYPE,
    inAsofClearing              IN     gsmac_position.asof_clearing%TYPE,
    inAsofSeg                   IN     gsmac_position.asof_seg%TYPE,
    inAsofBlock                 IN     gsmac_position.asof_block%TYPE,
    inAsofRecvColl              IN     gsmac_position.asof_recv_coll%TYPE,
    inAsofDelColl               IN     gsmac_position.asof_del_coll%TYPE,
    inAsofPendRec               IN     gsmac_position.asof_pend_rec%TYPE,
    inAsofPendDel               IN     gsmac_position.asof_pend_del%TYPE,
    inAsofBear                  IN     gsmac_position.asof_bear%TYPE,
    inRefInvType                IN     gsmac_position.ref_inv_type%TYPE,
    inRefOldCusip               IN     gsmac_position.ref_old_cusip%TYPE,
    inPosSecType                IN     gsmac_position.pos_sec_type%TYPE,
    inPosIssDt                  IN     gsmac_position.pos_iss_dt%TYPE,
    inPosFundSp                 IN     gsmac_position.pos_fund_sp%TYPE,
    inPosSecsAcct               IN     gsmac_position.pos_secs_acct%TYPE,
    inPosSetlAcct               IN     gsmac_position.pos_setl_acct%TYPE,
    inPosAsofDt                 IN     gsmac_position.pos_asof_dt%TYPE,
    inPosUserId                 IN     gsmac_position.pos_user_id%TYPE,
    inPosAction                 IN     gsmac_position.pos_action%TYPE,
    inPosUserDt                 IN     gsmac_position.pos_user_dt%TYPE,
    inPosUserTm                 IN     gsmac_position.pos_user_tm%TYPE,
    inPosPgmId                  IN     gsmac_position.pos_pgm_id%TYPE,
    inPosTranCd                 IN     gsmac_position.pos_tran_cd%TYPE,
    inPosSysDt                  IN     gsmac_position.pos_sys_dt%TYPE,
    inPosSysTm                  IN     gsmac_position.pos_sys_tm%TYPE,
    inPosPostDt                 IN     gsmac_position.pos_post_dt%TYPE,
    inPosPostTm                 IN     gsmac_position.pos_post_tm%TYPE,
    inPosDttm                   IN     gsmac_position.pos_dttm%TYPE,
	inAsofPendLoanDel           IN     gsmac_position.asof_pend_loan_del%TYPE,
	inPostotal					IN     gsmac_position.pos_total%TYPE,
    outPositionSeq                 OUT gsmac_position.position_seq%TYPE,
    outSecurityId                  OUT gsmac_position.security_id%TYPE);

PROCEDURE sp_Custody_Trans_03
   (inActTrdId                  IN     gsmac_transaction.act_trd_id%TYPE,
    inActTrdIdSeq               IN     gsmac_transaction.act_trd_id_seq%TYPE,
    inActStat                   IN     gsmac_transaction.act_stat%TYPE,
    inPosFund                   IN     gsmac_transaction.pos_fund%TYPE,
    inPosCusip                  IN     gsmac_transaction.pos_cusip%TYPE,
    inSourceCorrId              IN     gsmac_transaction.source_corr_id%TYPE,
    inMsgId                     IN     gsmac_transaction.msg_id%TYPE,
    inPositionSeq               IN     gsmac_transaction.position_seq%TYPE,
    inMessageSource             IN     gsmac_transaction.message_source%TYPE,
    inActMsgSrc                 IN     gsmac_transaction.act_msg_src%TYPE,
    inSecurityId                IN     gsmac_transaction.security_id%TYPE,
    inActTrdDt                  IN     gsmac_transaction.act_trd_dt%TYPE,
    inActCsd                    IN     gsmac_transaction.act_csd%TYPE,
    inActActualSetlDt           IN     gsmac_transaction.act_actual_setl_dt%TYPE,
    inPosSetlLoc                IN     gsmac_transaction.pos_setl_loc%TYPE,
    inActSetlAcct               IN     gsmac_transaction.act_setl_acct%TYPE,
    inActCurrCd                 IN     gsmac_transaction.act_curr_cd%TYPE,
    inActContShs                IN     gsmac_transaction.act_cont_shs%TYPE,
    inActActualShs              IN     gsmac_transaction.act_actual_shs%TYPE,
    inActContAmt                IN     gsmac_transaction.act_cont_amt%TYPE,
    inActNetAmt                 IN     gsmac_transaction.act_net_amt%TYPE,
    inActExecBrk                IN     gsmac_transaction.act_exec_brk%TYPE,
    inActClrngBrk               IN     gsmac_transaction.act_clrng_brk%TYPE,
    inActSysSetlDt              IN     gsmac_transaction.act_sys_setl_dt%TYPE,
    inActComment                IN     gsmac_transaction.act_comment%TYPE,
    inActNextSeq                IN     gsmac_transaction.act_next_seq%TYPE,
    inActTranType               IN     gsmac_transaction.act_tran_type%TYPE,
    inActTranQual               IN     gsmac_transaction.act_tran_qual%TYPE,
    inRefInvType                IN     gsmac_transaction.ref_inv_type%TYPE,
    inRefInvTypeDesc            IN     gsmac_transaction.ref_inv_type_desc%TYPE,
    inActRate                   IN     gsmac_transaction.act_rate%TYPE,
    inActMatDt                  IN     gsmac_transaction.act_mat_dt%TYPE,
    inActSecsAcct               IN     gsmac_transaction.act_secs_acct%TYPE,
    inActNxtDest                IN     gsmac_transaction.act_nxt_dest%TYPE,
    inActSubValDt               IN     gsmac_transaction.act_sub_val_dt%TYPE,
    inActSsbValDt               IN     gsmac_transaction.act_ssb_val_dt%TYPE,
    inActTranGrpId              IN     gsmac_transaction.act_tran_grp_id%TYPE,
    inActRelCashId              IN     gsmac_transaction.act_rel_cash_id%TYPE,
    inActIbsSeq                 IN     gsmac_transaction.act_ibs_seq%TYPE,
    inActBtchDt                 IN     gsmac_transaction.act_btch_dt%TYPE,
    inActBtchCd                 IN     gsmac_transaction.act_btch_cd%TYPE,
    inActBtchStat               IN     gsmac_transaction.act_btch_stat%TYPE,
    inActLastUser               IN     gsmac_transaction.act_last_user%TYPE,
    inActLastAction             IN     gsmac_transaction.act_last_action%TYPE,
    inActSysDt                  IN     gsmac_transaction.act_sys_dt%TYPE,
    inActSysDttm                IN     gsmac_transaction.act_sys_dttm%TYPE);

/* Overloaded */
PROCEDURE sp_ins_MessageCvw
   (inMsgId                     IN     message_cvw.msg_id%TYPE,
    inSourceCorrId              IN     message_cvw.source_corr_id%TYPE,
    inMsgType                   IN     message_cvw.msg_type%TYPE,
    inMsgSubType                IN     message_cvw.msg_sub_type%TYPE,
    inSrcSstm                   IN     message_cvw.src_sstm%TYPE,
    inDstntnSstm                IN     message_cvw.dstntn_sstm%TYPE,
    inMsgState                  IN     message_cvw.msg_state%TYPE,
    inQueueName                 IN     message_cvw.queue_name%TYPE,
    inMsgSendDttm               IN     message_cvw.msg_send_dttm%TYPE,
    inMsgRcvdDttm               IN     message_cvw.msg_rcvd_dttm%TYPE,
    inMsgVrsnNmbr               IN     message_cvw.msg_vrsn_nmbr%TYPE,
    inMsgTmstmp                 IN     message_cvw.msg_tmstmp%TYPE,
    inMsgClob                   IN     message_cvw.msg_clob%TYPE,
    inReplayFlg                 IN     message_cvw.replay_flg%TYPE,
    inReplayLgn                 IN     message_cvw.replay_lgn%TYPE,
    inReplayMsgId               IN     message_cvw.replay_msg_id%TYPE,
    inRefMsgId                  IN     message_cvw.ref_msg_id%TYPE,
    inUpdtLgn                   IN     message_cvw.updt_lgn%TYPE,
    inUpdtDttm                  IN     message_cvw.updt_dttm%TYPE);

/* Overloaded */
PROCEDURE sp_ins_MessageCvw
   (inSourceCorrId              IN     message_cvw.source_corr_id%TYPE,
    inMsgType                   IN     message_cvw.msg_type%TYPE,
    inMsgSubType                IN     message_cvw.msg_sub_type%TYPE,
    inSrcSstm                   IN     message_cvw.src_sstm%TYPE,
    inDstntnSstm                IN     message_cvw.dstntn_sstm%TYPE,
    inMsgState                  IN     message_cvw.msg_state%TYPE,
    inQueueName                 IN     message_cvw.queue_name%TYPE,
    inMsgSendDttm               IN     message_cvw.msg_send_dttm%TYPE,
    inMsgRcvdDttm               IN     message_cvw.msg_rcvd_dttm%TYPE,
    inMsgVrsnNmbr               IN     message_cvw.msg_vrsn_nmbr%TYPE,
    inMsgTmstmp                 IN     message_cvw.msg_tmstmp%TYPE,
    inMsgClob                   IN     message_cvw.msg_clob%TYPE,
    inReplayFlg                 IN     message_cvw.replay_flg%TYPE,
    inReplayLgn                 IN     message_cvw.replay_lgn%TYPE,
    inReplayMsgId               IN     message_cvw.replay_msg_id%TYPE,
    inRefMsgId                  IN     message_cvw.ref_msg_id%TYPE,
    inUpdtLgn                   IN     message_cvw.updt_lgn%TYPE,
    inUpdtDttm                  IN     message_cvw.updt_dttm%TYPE,
    outMsgId                       OUT message_cvw.msg_id%TYPE);

PROCEDURE sp_mrg_GsmacPosition
   (inPosFund                   IN     gsmac_position.pos_fund%TYPE,
    inPosSetlLoc                IN     gsmac_position.pos_setl_loc%TYPE,
    inPosCusip                  IN     gsmac_position.pos_cusip%TYPE,
    inSourceCorrId              IN     gsmac_position.source_corr_id%TYPE,
    inMsgId                     IN     gsmac_position.msg_id%TYPE,
    inMsgSrc                    IN     gsmac_position.msg_src%TYPE,
    inPosMatDt                  IN     gsmac_position.pos_mat_dt%TYPE,
    inPosRate                   IN     gsmac_position.pos_rate%TYPE,
    inSecurityId                IN     gsmac_position.security_id%TYPE,
    inPosSetlLocName            IN     gsmac_position.pos_setl_loc_name%TYPE,
    inPosFundName               IN     gsmac_position.pos_fund_name%TYPE,
    inPosAssetDesc              IN     gsmac_position.pos_asset_desc%TYPE,
    inAsofTradeDt               IN     gsmac_position.asof_trade_dt%TYPE,
    inAsofCsd                   IN     gsmac_position.asof_csd%TYPE,
    inAsofSafe                  IN     gsmac_position.asof_safe%TYPE,
    inAsofAvail                 IN     gsmac_position.asof_avail%TYPE,
    inAsofOutForReg             IN     gsmac_position.asof_out_for_reg%TYPE,
    inAsofReg                   IN     gsmac_position.asof_reg%TYPE,
    inAsofUnregOth              IN     gsmac_position.asof_unreg_oth%TYPE,
    inAsofUnregVol              IN     gsmac_position.asof_unreg_vol%TYPE,
    inAsofSsbBor                IN     gsmac_position.asof_ssb_bor%TYPE,
    inAsof3ptyBor               IN     gsmac_position.asof_3pty_bor%TYPE,
    inAsofSsbLoan               IN     gsmac_position.asof_ssb_loan%TYPE,
    inAsof3ptyLoan              IN     gsmac_position.asof_3pty_loan%TYPE,
    inAsofClearing              IN     gsmac_position.asof_clearing%TYPE,
    inAsofSeg                   IN     gsmac_position.asof_seg%TYPE,
    inAsofBlock                 IN     gsmac_position.asof_block%TYPE,
    inAsofRecvColl              IN     gsmac_position.asof_recv_coll%TYPE,
    inAsofDelColl               IN     gsmac_position.asof_del_coll%TYPE,
    inAsofPendRec               IN     gsmac_position.asof_pend_rec%TYPE,
    inAsofPendDel               IN     gsmac_position.asof_pend_del%TYPE,
    inAsofBear                  IN     gsmac_position.asof_bear%TYPE,
    inRefInvType                IN     gsmac_position.ref_inv_type%TYPE,
    inRefOldCusip               IN     gsmac_position.ref_old_cusip%TYPE,
    inPosSecType                IN     gsmac_position.pos_sec_type%TYPE,
    inPosIssDt                  IN     gsmac_position.pos_iss_dt%TYPE,
    inPosFundSp                 IN     gsmac_position.pos_fund_sp%TYPE,
    inPosSecsAcct               IN     gsmac_position.pos_secs_acct%TYPE,
    inPosSetlAcct               IN     gsmac_position.pos_setl_acct%TYPE,
    inPosAsofDt                 IN     gsmac_position.pos_asof_dt%TYPE,
    inPosUserId                 IN     gsmac_position.pos_user_id%TYPE,
    inPosAction                 IN     gsmac_position.pos_action%TYPE,
    inPosUserDt                 IN     gsmac_position.pos_user_dt%TYPE,
    inPosUserTm                 IN     gsmac_position.pos_user_tm%TYPE,
    inPosPgmId                  IN     gsmac_position.pos_pgm_id%TYPE,
    inPosTranCd                 IN     gsmac_position.pos_tran_cd%TYPE,
    inPosSysDt                  IN     gsmac_position.pos_sys_dt%TYPE,
    inPosSysTm                  IN     gsmac_position.pos_sys_tm%TYPE,
    inPosPostDt                 IN     gsmac_position.pos_post_dt%TYPE,
    inPosPostTm                 IN     gsmac_position.pos_post_tm%TYPE,
    inPosDttm                   IN     gsmac_position.pos_dttm%TYPE,
	inAsofPendLoanDel			IN     gsmac_position.asof_pend_loan_del%TYPE,
	inPostotal					IN     gsmac_position.pos_total%TYPE);

PROCEDURE sp_ins_GsmacPositionHistory
   (inPosFund                   IN     gsmac_position_history.pos_fund%TYPE,
    inPosSetlLoc                IN     gsmac_position_history.pos_setl_loc%TYPE,
    inPosCusip                  IN     gsmac_position_history.pos_cusip%TYPE,
    inActTrdId                  IN     gsmac_position_history.act_trd_id%TYPE,
    inSourceCorrId              IN     gsmac_position_history.source_corr_id%TYPE,
    inMsgId                     IN     gsmac_position_history.msg_id%TYPE,
    inMsgSrc                    IN     gsmac_position_history.msg_src%TYPE,
    inPositionSeq               IN     gsmac_position_history.position_seq%TYPE,
    inPosMatDt                  IN     gsmac_position_history.pos_mat_dt%TYPE,
    inPosRate                   IN     gsmac_position_history.pos_rate%TYPE,
    inSecurityId                IN     gsmac_position_history.security_id%TYPE,
    inPosSetlLocName            IN     gsmac_position_history.pos_setl_loc_name%TYPE,
    inPosFundName               IN     gsmac_position_history.pos_fund_name%TYPE,
    inPosAssetDesc              IN     gsmac_position_history.pos_asset_desc%TYPE,
    inAsofTradeDt               IN     gsmac_position_history.asof_trade_dt%TYPE,
    inAsofCsd                   IN     gsmac_position_history.asof_csd%TYPE,
    inAsofSafe                  IN     gsmac_position_history.asof_safe%TYPE,
    inAsofAvail                 IN     gsmac_position_history.asof_avail%TYPE,
    inAsofOutForReg             IN     gsmac_position_history.asof_out_for_reg%TYPE,
    inAsofReg                   IN     gsmac_position_history.asof_reg%TYPE,
    inAsofUnregOth              IN     gsmac_position_history.asof_unreg_oth%TYPE,
    inAsofUnregVol              IN     gsmac_position_history.asof_unreg_vol%TYPE,
    inAsofSsbBor                IN     gsmac_position_history.asof_ssb_bor%TYPE,
    inAsof3PtyBor               IN     gsmac_position_history.asof_3pty_bor%TYPE,
    inAsofSsbLoan               IN     gsmac_position_history.asof_ssb_loan%TYPE,
    inAsof3PtyLoan              IN     gsmac_position_history.asof_3pty_loan%TYPE,
    inAsofClearing              IN     gsmac_position_history.asof_clearing%TYPE,
    inAsofSeg                   IN     gsmac_position_history.asof_seg%TYPE,
    inAsofBlock                 IN     gsmac_position_history.asof_block%TYPE,
    inAsofRecvColl              IN     gsmac_position_history.asof_recv_coll%TYPE,
    inAsofDelColl               IN     gsmac_position_history.asof_del_coll%TYPE,
    inAsofPendRec               IN     gsmac_position_history.asof_pend_rec%TYPE,
    inAsofPendDel               IN     gsmac_position_history.asof_pend_del%TYPE,
    inAsofBear                  IN     gsmac_position_history.asof_bear%TYPE,
    inRefInvType                IN     gsmac_position_history.ref_inv_type%TYPE,
    inRefOldCusip               IN     gsmac_position_history.ref_old_cusip%TYPE,
    inPosSecType                IN     gsmac_position_history.pos_sec_type%TYPE,
    inPosIssDt                  IN     gsmac_position_history.pos_iss_dt%TYPE,
    inPosFundSp                 IN     gsmac_position_history.pos_fund_sp%TYPE,
    inPosSecsAcct               IN     gsmac_position_history.pos_secs_acct%TYPE,
    inPosSetlAcct               IN     gsmac_position_history.pos_setl_acct%TYPE,
    inPosAsofDt                 IN     gsmac_position_history.pos_asof_dt%TYPE,
    inPosUserId                 IN     gsmac_position_history.pos_user_id%TYPE,
    inPosAction                 IN     gsmac_position_history.pos_action%TYPE,
    inPosUserDt                 IN     gsmac_position_history.pos_user_dt%TYPE,
    inPosUserTm                 IN     gsmac_position_history.pos_user_tm%TYPE,
    inPosPgmId                  IN     gsmac_position_history.pos_pgm_id%TYPE,
    inPosTranCd                 IN     gsmac_position_history.pos_tran_cd%TYPE,
    inPosSysDt                  IN     gsmac_position_history.pos_sys_dt%TYPE,
    inPosSysTm                  IN     gsmac_position_history.pos_sys_tm%TYPE,
    inPosPostDt                 IN     gsmac_position_history.pos_post_dt%TYPE,
    inPosPostTm                 IN     gsmac_position_history.pos_post_tm%TYPE,
    inPosDttm                   IN     gsmac_position_history.pos_dttm%TYPE,
	inAsofPendLoanDel           IN     gsmac_position_history.asof_pend_loan_del%TYPE,
	inPostotal					IN     gsmac_position_history.pos_total%TYPE);

PROCEDURE sp_mrg_GsmacTransaction
   (inActTrdId                  IN     gsmac_transaction.act_trd_id%TYPE,
    inActTrdIdSeq               IN     gsmac_transaction.act_trd_id_seq%TYPE,
    inActStat                   IN     gsmac_transaction.act_stat%TYPE,
    inPosFund                   IN     gsmac_transaction.pos_fund%TYPE,
    inPosCusip                  IN     gsmac_transaction.pos_cusip%TYPE,
    inSourceCorrId              IN     gsmac_transaction.source_corr_id%TYPE,
    inMsgId                     IN     gsmac_transaction.msg_id%TYPE,
    inPositionSeq               IN     gsmac_transaction.position_seq%TYPE,
    inMessageSource             IN     gsmac_transaction.message_source%TYPE,
    inActMsgSrc                 IN     gsmac_transaction.act_msg_src%TYPE,
    inSecurityId                IN     gsmac_transaction.security_id%TYPE,
    inActTrdDt                  IN     gsmac_transaction.act_trd_dt%TYPE,
    inActCsd                    IN     gsmac_transaction.act_csd%TYPE,
    inActActualSetlDt           IN     gsmac_transaction.act_actual_setl_dt%TYPE,
    inPosSetlLoc                IN     gsmac_transaction.pos_setl_loc%TYPE,
    inActSetlAcct               IN     gsmac_transaction.act_setl_acct%TYPE,
    inActCurrCd                 IN     gsmac_transaction.act_curr_cd%TYPE,
    inActContShs                IN     gsmac_transaction.act_cont_shs%TYPE,
    inActActualShs              IN     gsmac_transaction.act_actual_shs%TYPE,
    inActContAmt                IN     gsmac_transaction.act_cont_amt%TYPE,
    inActNetAmt                 IN     gsmac_transaction.act_net_amt%TYPE,
    inActExecBrk                IN     gsmac_transaction.act_exec_brk%TYPE,
    inActClrngBrk               IN     gsmac_transaction.act_clrng_brk%TYPE,
    inActSysSetlDt              IN     gsmac_transaction.act_sys_setl_dt%TYPE,
    inActComment                IN     gsmac_transaction.act_comment%TYPE,
    inActNextSeq                IN     gsmac_transaction.act_next_seq%TYPE,
    inActTranType               IN     gsmac_transaction.act_tran_type%TYPE,
    inActTranQual               IN     gsmac_transaction.act_tran_qual%TYPE,
    inRefInvType                IN     gsmac_transaction.ref_inv_type%TYPE,
    inRefInvTypeDesc            IN     gsmac_transaction.ref_inv_type_desc%TYPE,
    inActRate                   IN     gsmac_transaction.act_rate%TYPE,
    inActMatDt                  IN     gsmac_transaction.act_mat_dt%TYPE,
    inActSecsAcct               IN     gsmac_transaction.act_secs_acct%TYPE,
    inActNxtDest                IN     gsmac_transaction.act_nxt_dest%TYPE,
    inActSubValDt               IN     gsmac_transaction.act_sub_val_dt%TYPE,
    inActSsbValDt               IN     gsmac_transaction.act_ssb_val_dt%TYPE,
    inActTranGrpId              IN     gsmac_transaction.act_tran_grp_id%TYPE,
    inActRelCashId              IN     gsmac_transaction.act_rel_cash_id%TYPE,
    inActIbsSeq                 IN     gsmac_transaction.act_ibs_seq%TYPE,
    inActBtchDt                 IN     gsmac_transaction.act_btch_dt%TYPE,
    inActBtchCd                 IN     gsmac_transaction.act_btch_cd%TYPE,
    inActBtchStat               IN     gsmac_transaction.act_btch_stat%TYPE,
    inActLastUser               IN     gsmac_transaction.act_last_user%TYPE,
    inActLastAction             IN     gsmac_transaction.act_last_action%TYPE,
    inActSysDt                  IN     gsmac_transaction.act_sys_dt%TYPE,
    inActSysDttm                IN     gsmac_transaction.act_sys_dttm%TYPE);

PROCEDURE sp_ins_GsmacTransactionHistory
   (inActTrdId                  IN     gsmac_transaction_history.act_trd_id%TYPE,
    inActTrdIdSeq               IN     gsmac_transaction_history.act_trd_id_seq%TYPE,
    inActStat                   IN     gsmac_transaction_history.act_stat%TYPE,
    inPosFund                   IN     gsmac_transaction_history.pos_fund%TYPE,
    inPosCusip                  IN     gsmac_transaction_history.pos_cusip%TYPE,
    inSourceCorrId              IN     gsmac_transaction_history.source_corr_id%TYPE,
    inMsgId                     IN     gsmac_transaction_history.msg_id%TYPE,
    inPositionSeq               IN     gsmac_transaction_history.position_seq%TYPE,
    inMessageSource             IN     gsmac_transaction_history.message_source%TYPE,
    inActMsgSrc                 IN     gsmac_transaction_history.act_msg_src%TYPE,
    inSecurityId                IN     gsmac_transaction_history.security_id%TYPE,
    inActTrdDt                  IN     gsmac_transaction_history.act_trd_dt%TYPE,
    inActCsd                    IN     gsmac_transaction_history.act_csd%TYPE,
    inActActualSetlDt           IN     gsmac_transaction_history.act_actual_setl_dt%TYPE,
    inPosSetlLoc                IN     gsmac_transaction_history.pos_setl_loc%TYPE,
    inActSetlAcct               IN     gsmac_transaction_history.act_setl_acct%TYPE,
    inActCurrCd                 IN     gsmac_transaction_history.act_curr_cd%TYPE,
    inActContShs                IN     gsmac_transaction_history.act_cont_shs%TYPE,
    inActActualShs              IN     gsmac_transaction_history.act_actual_shs%TYPE,
    inActContAmt                IN     gsmac_transaction_history.act_cont_amt%TYPE,
    inActNetAmt                 IN     gsmac_transaction_history.act_net_amt%TYPE,
    inActExecBrk                IN     gsmac_transaction_history.act_exec_brk%TYPE,
    inActClrngBrk               IN     gsmac_transaction_history.act_clrng_brk%TYPE,
    inActSysSetlDt              IN     gsmac_transaction_history.act_sys_setl_dt%TYPE,
    inActComment                IN     gsmac_transaction_history.act_comment%TYPE,
    inActNextSeq                IN     gsmac_transaction_history.act_next_seq%TYPE,
    inActTranType               IN     gsmac_transaction_history.act_tran_type%TYPE,
    inActTranQual               IN     gsmac_transaction_history.act_tran_qual%TYPE,
    inRefInvType                IN     gsmac_transaction_history.ref_inv_type%TYPE,
    inRefInvTypeDesc            IN     gsmac_transaction_history.ref_inv_type_desc%TYPE,
    inActRate                   IN     gsmac_transaction_history.act_rate%TYPE,
    inActMatDt                  IN     gsmac_transaction_history.act_mat_dt%TYPE,
    inActSecsAcct               IN     gsmac_transaction_history.act_secs_acct%TYPE,
    inActNxtDest                IN     gsmac_transaction_history.act_nxt_dest%TYPE,
    inActSubValDt               IN     gsmac_transaction_history.act_sub_val_dt%TYPE,
    inActSsbValDt               IN     gsmac_transaction_history.act_ssb_val_dt%TYPE,
    inActTranGrpId              IN     gsmac_transaction_history.act_tran_grp_id%TYPE,
    inActRelCashId              IN     gsmac_transaction_history.act_rel_cash_id%TYPE,
    inActIbsSeq                 IN     gsmac_transaction_history.act_ibs_seq%TYPE,
    inActBtchDt                 IN     gsmac_transaction_history.act_btch_dt%TYPE,
    inActBtchCd                 IN     gsmac_transaction_history.act_btch_cd%TYPE,
    inActBtchStat               IN     gsmac_transaction_history.act_btch_stat%TYPE,
    inActLastUser               IN     gsmac_transaction_history.act_last_user%TYPE,
    inActLastAction             IN     gsmac_transaction_history.act_last_action%TYPE,
    inActSysDt                  IN     gsmac_transaction_history.act_sys_dt%TYPE,
    inActSysDttm                IN     gsmac_transaction_history.act_sys_dttm%TYPE);

PROCEDURE sp_ins_StgGsmacPosition
   (inMsgId                 IN     stg_gsmac_position.msg_id%TYPE,
    inF20                   IN     stg_gsmac_position.f20%TYPE,
    inPosSetlLoc            IN     stg_gsmac_position.pos_setl_loc%TYPE,
    inPosSecsAcct           IN     stg_gsmac_position.pos_secs_acct%TYPE,
    inPosSetlAcct           IN     stg_gsmac_position.pos_setl_acct%TYPE,
    inPosCusip              IN     stg_gsmac_position.pos_cusip%TYPE,
    inPosMatDt              IN     stg_gsmac_position.pos_mat_dt%TYPE,
    inPosRate               IN     stg_gsmac_position.pos_rate%TYPE,
    inPosSecType            IN     stg_gsmac_position.pos_sec_type%TYPE,
    inPosIssDt              IN     stg_gsmac_position.pos_iss_dt%TYPE,
    inPosFund               IN     stg_gsmac_position.pos_fund%TYPE,
    inPosFundSp             IN     stg_gsmac_position.pos_fund_sp%TYPE,
    inPosAsofDt             IN     stg_gsmac_position.pos_asof_dt%TYPE,
    inAsofTradeDt           IN     stg_gsmac_position.asof_trade_dt%TYPE,
    inAsofCsd               IN     stg_gsmac_position.asof_csd%TYPE,
    inAsofSafe              IN     stg_gsmac_position.asof_safe%TYPE,
    inAsofAvail             IN     stg_gsmac_position.asof_avail%TYPE,
    inAsofOutForReg         IN     stg_gsmac_position.asof_out_for_reg%TYPE,
    inAsofReg               IN     stg_gsmac_position.asof_reg%TYPE,
    inAsofUnregOth          IN     stg_gsmac_position.asof_unreg_oth%TYPE,
    inAsofUnregVol          IN     stg_gsmac_position.asof_unreg_vol%TYPE,
    inAsofSsbBor            IN     stg_gsmac_position.asof_ssb_bor%TYPE,
    inAsof3ptyBor           IN     stg_gsmac_position.asof_3pty_bor%TYPE,
    inAsofSsbLoan           IN     stg_gsmac_position.asof_ssb_loan%TYPE,
    inAsof3ptyLoan          IN     stg_gsmac_position.asof_3pty_loan%TYPE,
    inAsofClearing          IN     stg_gsmac_position.asof_clearing%TYPE,
    inAsofSeg               IN     stg_gsmac_position.asof_seg%TYPE,
    inAsofBlock             IN     stg_gsmac_position.asof_block%TYPE,
    inAsofRecvColl          IN     stg_gsmac_position.asof_recv_coll%TYPE,
    inAsofDelColl           IN     stg_gsmac_position.asof_del_coll%TYPE,
    inAsofPendRec           IN     stg_gsmac_position.asof_pend_rec%TYPE,
    inAsofPendDel           IN     stg_gsmac_position.asof_pend_del%TYPE,
    inHistTradeDt           IN     stg_gsmac_position.hist_trade_dt%TYPE,
    inHistCsd               IN     stg_gsmac_position.hist_csd%TYPE,
    inHistSafe              IN     stg_gsmac_position.hist_safe%TYPE,
    inHistAvail             IN     stg_gsmac_position.hist_avail%TYPE,
    inHistOutForReg         IN     stg_gsmac_position.hist_out_for_reg%TYPE,
    inHistReg               IN     stg_gsmac_position.hist_reg%TYPE,
    inHistUnregOth          IN     stg_gsmac_position.hist_unreg_oth%TYPE,
    inHistUnregVol          IN     stg_gsmac_position.hist_unreg_vol%TYPE,
    inHistSsbBor            IN     stg_gsmac_position.hist_ssb_bor%TYPE,
    inHist3ptyBor           IN     stg_gsmac_position.hist_3pty_bor%TYPE,
    inHistSsbLoan           IN     stg_gsmac_position.hist_ssb_loan%TYPE,
    inHist3ptyLoan          IN     stg_gsmac_position.hist_3pty_loan%TYPE,
    inHistClearing          IN     stg_gsmac_position.hist_clearing%TYPE,
    inHistSeg               IN     stg_gsmac_position.hist_seg%TYPE,
    inHistBlock             IN     stg_gsmac_position.hist_block%TYPE,
    inHistRecvColl          IN     stg_gsmac_position.hist_recv_coll%TYPE,
    inHistDelColl           IN     stg_gsmac_position.hist_del_coll%TYPE,
    inHistPendRec           IN     stg_gsmac_position.hist_pend_rec%TYPE,
    inHistPendDel           IN     stg_gsmac_position.hist_pend_del%TYPE,
    inAsofBear              IN     stg_gsmac_position.asof_bear%TYPE,
    inHistBear              IN     stg_gsmac_position.hist_bear%TYPE,
    inPosUserId             IN     stg_gsmac_position.pos_user_id%TYPE,
    inPosAction             IN     stg_gsmac_position.pos_action%TYPE,
    inPosUserDt             IN     stg_gsmac_position.pos_user_dt%TYPE,
    inPosUserTm             IN     stg_gsmac_position.pos_user_tm%TYPE,
    inPosPgmId              IN     stg_gsmac_position.pos_pgm_id%TYPE,
    inPosTranCd             IN     stg_gsmac_position.pos_tran_cd%TYPE,
    inPosSysDt              IN     stg_gsmac_position.pos_sys_dt%TYPE,
    inPosSysTm              IN     stg_gsmac_position.pos_sys_tm%TYPE,
    inPosPostDt             IN     stg_gsmac_position.pos_post_dt%TYPE,
    inPosPostTm             IN     stg_gsmac_position.pos_post_tm%TYPE,
    inPosDttm               IN     stg_gsmac_position.pos_dttm%TYPE);

PROCEDURE sp_ins_StgGsmacTransaction
   (inMsgId                 IN     stg_gsmac_transaction.msg_id%TYPE,
    inF20                   IN     stg_gsmac_transaction.f20%TYPE,
    inTopic                 IN     stg_gsmac_transaction.topic%TYPE,
    inVersion               IN     stg_gsmac_transaction.version%TYPE,
    inMt599Sequence         IN     stg_gsmac_transaction.mt599_sequence%TYPE,
    inF28                   IN     stg_gsmac_transaction.f28%TYPE,
    inF83a                  IN     stg_gsmac_transaction.f83a%TYPE,
    inF67a                  IN     stg_gsmac_transaction.f67a%TYPE,
    inF98a                  IN     stg_gsmac_transaction.f98a%TYPE,
    inF99a                  IN     stg_gsmac_transaction.f99a%TYPE,
    inD99                   IN     stg_gsmac_transaction.d99%TYPE,
    inF35b                  IN     stg_gsmac_transaction.f35b%TYPE,
    inF35a                  IN     stg_gsmac_transaction.f35a%TYPE,
    inF66a                  IN     stg_gsmac_transaction.f66a%TYPE,
    inF30                   IN     stg_gsmac_transaction.f30%TYPE,
    inF34a                  IN     stg_gsmac_transaction.f34a%TYPE,
    inF18a                  IN     stg_gsmac_transaction.f18a%TYPE,
    inRefCusip              IN     stg_gsmac_transaction.ref_cusip%TYPE,
    inRefTicker             IN     stg_gsmac_transaction.ref_ticker%TYPE,
    inRefInvType            IN     stg_gsmac_transaction.ref_inv_type%TYPE,
    inRefInvTypeDesc        IN     stg_gsmac_transaction.ref_inv_type_desc%TYPE,
    inRefIssueName          IN     stg_gsmac_transaction.ref_issue_name%TYPE,
    inRefIssueDesc          IN     stg_gsmac_transaction.ref_issue_desc%TYPE,
    inRefRate               IN     stg_gsmac_transaction.ref_rate%TYPE,
    inRefMatDt              IN     stg_gsmac_transaction.ref_mat_dt%TYPE,
    inRefAsstCls            IN     stg_gsmac_transaction.ref_asst_cls%TYPE,
    inRefNraTxctry          IN     stg_gsmac_transaction.ref_nra_txctry%TYPE,
    inRefGvtPoolNo          IN     stg_gsmac_transaction.ref_gvt_pool_no%TYPE,
    inRefOldCusip           IN     stg_gsmac_transaction.ref_old_cusip%TYPE,
    inRefJgbSw              IN     stg_gsmac_transaction.ref_jgb_sw%TYPE,
    inRefRednmSw            IN     stg_gsmac_transaction.ref_rednm_sw%TYPE,
    inRefEuroHistSw         IN     stg_gsmac_transaction.ref_euro_hist_sw%TYPE,
    inRefVarRtSw            IN     stg_gsmac_transaction.ref_var_rt_sw%TYPE,
    inActFund               IN     stg_gsmac_transaction.act_fund%TYPE,
    inActClRef              IN     stg_gsmac_transaction.act_cl_ref%TYPE,
    inActCusip              IN     stg_gsmac_transaction.act_cusip%TYPE,
    inActMatDt              IN     stg_gsmac_transaction.act_mat_dt%TYPE,
    inActRate               IN     stg_gsmac_transaction.act_rate%TYPE,
    inActSecTyp             IN     stg_gsmac_transaction.act_sec_typ%TYPE,
    inActIssDt              IN     stg_gsmac_transaction.act_iss_dt%TYPE,
    inActTrdId              IN     stg_gsmac_transaction.act_trd_id%TYPE,
    inActTrdIdSeq           IN     stg_gsmac_transaction.act_trd_id_seq%TYPE,
    inActTranType           IN     stg_gsmac_transaction.act_tran_type%TYPE,
    inActTranQual           IN     stg_gsmac_transaction.act_tran_qual%TYPE,
    inActTrdDt              IN     stg_gsmac_transaction.act_trd_dt%TYPE,
    inActCsd                IN     stg_gsmac_transaction.act_csd%TYPE,
    inActContShs            IN     stg_gsmac_transaction.act_cont_shs%TYPE,
    inActOrigFace           IN     stg_gsmac_transaction.act_orig_face%TYPE,
    inActContAmt            IN     stg_gsmac_transaction.act_cont_amt%TYPE,
    inActCurrCd             IN     stg_gsmac_transaction.act_curr_cd%TYPE,
    inActPmtMeth            IN     stg_gsmac_transaction.act_pmt_meth%TYPE,
    inActExecBrk            IN     stg_gsmac_transaction.act_exec_brk%TYPE,
    inActClrngBrk           IN     stg_gsmac_transaction.act_clrng_brk%TYPE,
    inActClrngBnk           IN     stg_gsmac_transaction.act_clrng_bnk%TYPE,
    inActRelTrdId           IN     stg_gsmac_transaction.act_rel_trd_id%TYPE,
    inActRelTrdIdSeq        IN     stg_gsmac_transaction.act_rel_trd_id_seq%TYPE,
    inActCorpActnId         IN     stg_gsmac_transaction.act_corp_actn_id%TYPE,
    inActSetlLoc            IN     stg_gsmac_transaction.act_setl_loc%TYPE,
    inActSetlAcct           IN     stg_gsmac_transaction.act_setl_acct%TYPE,
    inActSecsAcct           IN     stg_gsmac_transaction.act_secs_acct%TYPE,
    inActSetLocRef          IN     stg_gsmac_transaction.act_set_loc_ref%TYPE,
    inActFullPart           IN     stg_gsmac_transaction.act_full_part%TYPE,
    inActStlLvl             IN     stg_gsmac_transaction.act_stl_lvl%TYPE,
    inActActualShs          IN     stg_gsmac_transaction.act_actual_shs%TYPE,
    inActNetAmt             IN     stg_gsmac_transaction.act_net_amt%TYPE,
    inActCommShs            IN     stg_gsmac_transaction.act_comm_shs%TYPE,
    inActActualSetlDt       IN     stg_gsmac_transaction.act_actual_setl_dt%TYPE,
    inActSysSetlDt          IN     stg_gsmac_transaction.act_sys_setl_dt%TYPE,
    inActTranIdTyp          IN     stg_gsmac_transaction.act_tran_id_typ%TYPE,
    inActTranGrpId          IN     stg_gsmac_transaction.act_tran_grp_id%TYPE,
    inActRelCashId          IN     stg_gsmac_transaction.act_rel_cash_id%TYPE,
    inActRelCashSeq         IN     stg_gsmac_transaction.act_rel_cash_seq%TYPE,
    inActRelCashLnk         IN     stg_gsmac_transaction.act_rel_cash_lnk%TYPE,
    inActBtchDt             IN     stg_gsmac_transaction.act_btch_dt%TYPE,
    inActBtchCd             IN     stg_gsmac_transaction.act_btch_cd%TYPE,
    inActBtchStat           IN     stg_gsmac_transaction.act_btch_stat%TYPE,
    inActNextSeq            IN     stg_gsmac_transaction.act_next_seq%TYPE,
    inActEuclidTyp          IN     stg_gsmac_transaction.act_euclid_typ%TYPE,
    inActEuclidPri          IN     stg_gsmac_transaction.act_euclid_pri%TYPE,
    inActSwMsgPri           IN     stg_gsmac_transaction.act_sw_msg_pri%TYPE,
    inActSwMsgStat          IN     stg_gsmac_transaction.act_sw_msg_stat%TYPE,
    inActRegReq             IN     stg_gsmac_transaction.act_reg_req%TYPE,
    inActNxtDest            IN     stg_gsmac_transaction.act_nxt_dest%TYPE,
    inActEventTyp           IN     stg_gsmac_transaction.act_event_typ%TYPE,
    inActRptDt              IN     stg_gsmac_transaction.act_rpt_dt%TYPE,
    inActIscuRptDt          IN     stg_gsmac_transaction.act_iscu_rpt_dt%TYPE,
    inActEtaDt              IN     stg_gsmac_transaction.act_eta_dt%TYPE,
    inActFailRsn            IN     stg_gsmac_transaction.act_fail_rsn%TYPE,
    inActRsn                IN     stg_gsmac_transaction.act_rsn%TYPE,
    inActPshsRsn            IN     stg_gsmac_transaction.act_pshs_rsn%TYPE,
    inActFailDt             IN     stg_gsmac_transaction.act_fail_dt%TYPE,
    inActRegShs             IN     stg_gsmac_transaction.act_reg_shs%TYPE,
    inActUnregShs           IN     stg_gsmac_transaction.act_unreg_shs%TYPE,
    inActUnregFor           IN     stg_gsmac_transaction.act_unreg_for%TYPE,
    inActRegAffAvl          IN     stg_gsmac_transaction.act_reg_aff_avl%TYPE,
    inActTrddtUpd           IN     stg_gsmac_transaction.act_trddt_upd%TYPE,
    inActRecDel             IN     stg_gsmac_transaction.act_rec_del%TYPE,
    inActStat               IN     stg_gsmac_transaction.act_stat%TYPE,
    inActComment            IN     stg_gsmac_transaction.act_comment%TYPE,
    inActFfPrtDt            IN     stg_gsmac_transaction.act_ff_prt_dt%TYPE,
    inActFfDomn             IN     stg_gsmac_transaction.act_ff_domn%TYPE,
    inActFfSeq              IN     stg_gsmac_transaction.act_ff_seq%TYPE,
    inActFfRprnt            IN     stg_gsmac_transaction.act_ff_rprnt%TYPE,
    inActErr1               IN     stg_gsmac_transaction.act_err1%TYPE,
    inActErr2               IN     stg_gsmac_transaction.act_err2%TYPE,
    inActErr3               IN     stg_gsmac_transaction.act_err3%TYPE,
    inActLastUser           IN     stg_gsmac_transaction.act_last_user%TYPE,
    inActLastAction         IN     stg_gsmac_transaction.act_last_action%TYPE,
    inActLastDt             IN     stg_gsmac_transaction.act_last_dt%TYPE,
    inActLastTm             IN     stg_gsmac_transaction.act_last_tm%TYPE,
    inActLastPgm            IN     stg_gsmac_transaction.act_last_pgm%TYPE,
    inActLastTran           IN     stg_gsmac_transaction.act_last_tran%TYPE,
    inActSysDt              IN     stg_gsmac_transaction.act_sys_dt%TYPE,
    inActSysTm              IN     stg_gsmac_transaction.act_sys_tm%TYPE,
    inActBearShs            IN     stg_gsmac_transaction.act_bear_shs%TYPE,
    inActShsRtn             IN     stg_gsmac_transaction.act_shs_rtn%TYPE,
    inActRetShsId           IN     stg_gsmac_transaction.act_ret_shs_id%TYPE,
    inActRetShsSeq          IN     stg_gsmac_transaction.act_ret_shs_seq%TYPE,
    inActXferId             IN     stg_gsmac_transaction.act_xfer_id%TYPE,
    inActSubValDt           IN     stg_gsmac_transaction.act_sub_val_dt%TYPE,
    inActSsbValDt           IN     stg_gsmac_transaction.act_ssb_val_dt%TYPE,
    inActContCshDt          IN     stg_gsmac_transaction.act_cont_csh_dt%TYPE,
    inActContCshTm          IN     stg_gsmac_transaction.act_cont_csh_tm%TYPE,
    inActIbsSeq             IN     stg_gsmac_transaction.act_ibs_seq%TYPE,
    inActContStlFl          IN     stg_gsmac_transaction.act_cont_stl_fl%TYPE,
    inActCashFp             IN     stg_gsmac_transaction.act_cash_fp%TYPE,
    inActOmniId             IN     stg_gsmac_transaction.act_omni_id%TYPE,
    inActOmniSeq            IN     stg_gsmac_transaction.act_omni_seq%TYPE,
    inActOmniShs            IN     stg_gsmac_transaction.act_omni_shs%TYPE,
    inActOmniNet            IN     stg_gsmac_transaction.act_omni_net%TYPE,
    inActTranLvl            IN     stg_gsmac_transaction.act_tran_lvl%TYPE,
    inActSysDttm            IN     stg_gsmac_transaction.act_sys_dttm%TYPE,
    inActDdaValdt           IN     stg_gsmac_transaction.act_dda_valdt%TYPE,
    inActErrors             IN     stg_gsmac_transaction.act_errors%TYPE,
    inActIbsAcct            IN     stg_gsmac_transaction.act_ibs_acct%TYPE,
    inActIbsInst            IN     stg_gsmac_transaction.act_ibs_inst%TYPE,
    inActIbsRegAcct         IN     stg_gsmac_transaction.act_ibs_reg_acct%TYPE,
    inActIbsRegInst         IN     stg_gsmac_transaction.act_ibs_reg_inst%TYPE,
    inActSubRefno           IN     stg_gsmac_transaction.act_sub_refno%TYPE,
    inActExecBicOr          IN     stg_gsmac_transaction.act_exec_bic_or%TYPE,
    inActClrngBicOr         IN     stg_gsmac_transaction.act_clrng_bic_or%TYPE,
    inActSafeAcct           IN     stg_gsmac_transaction.act_safe_acct%TYPE,
    inActIsin               IN     stg_gsmac_transaction.act_isin%TYPE,
    inActFundCtry           IN     stg_gsmac_transaction.act_fund_ctry%TYPE,
    inActTrdInstCrt         IN     stg_gsmac_transaction.act_trd_inst_crt%TYPE,
    inActCurrInd            IN     stg_gsmac_transaction.act_curr_ind%TYPE,
    inActCurrentInd         IN     stg_gsmac_transaction.act_current_ind%TYPE,
    inActMt54xTyp           IN     stg_gsmac_transaction.act_mt54x_typ%TYPE,
    inActMsgSrc             IN     stg_gsmac_transaction.act_msg_src%TYPE,
    inActAddtlNarr          IN     stg_gsmac_transaction.act_addtl_narr%TYPE,
    inActCurrSeq            IN     stg_gsmac_transaction.act_curr_seq%TYPE,
    inActBlkLink            IN     stg_gsmac_transaction.act_blk_link%TYPE,
    inActAllocsVsMoney      IN     stg_gsmac_transaction.act_allocs_vs_money%TYPE,
    inActCsdFundDt          IN     stg_gsmac_transaction.act_csd_fund_dt%TYPE,
    inActCsdRevDt           IN     stg_gsmac_transaction.act_csd_rev_dt%TYPE,
    inActBktolExc           IN     stg_gsmac_transaction.act_bktol_exc%TYPE,
    inActStampDuty          IN     stg_gsmac_transaction.act_stamp_duty%TYPE,
    inActRshsLinked         IN     stg_gsmac_transaction.act_rshs_linked%TYPE,
    inActOrderNum           IN     stg_gsmac_transaction.act_order_num%TYPE,
    inActUptRptInd          IN     stg_gsmac_transaction.act_upt_rpt_ind%TYPE,
    inActShortInd           IN     stg_gsmac_transaction.act_short_ind%TYPE,
    inF72                   IN     stg_gsmac_transaction.f72%TYPE,
    inF77b001               IN     stg_gsmac_transaction.f77b_001%TYPE,
    inF77b002               IN     stg_gsmac_transaction.f77b_002%TYPE,
    inF77d001               IN     stg_gsmac_transaction.f77d_001%TYPE,
    inF77d002               IN     stg_gsmac_transaction.f77d_002%TYPE,
    inF85c                  IN     stg_gsmac_transaction.f85c%TYPE,
    inF85d                  IN     stg_gsmac_transaction.f85d%TYPE,
    inF87a                  IN     stg_gsmac_transaction.f87a%TYPE,
    inF87d                  IN     stg_gsmac_transaction.f87d%TYPE,
    inF88c                  IN     stg_gsmac_transaction.f88c%TYPE,
    inF88d                  IN     stg_gsmac_transaction.f88d%TYPE,
    inF33v                  IN     stg_gsmac_transaction.f33v%TYPE,
    inS901                  IN     stg_gsmac_transaction.s901%TYPE,
    inS902                  IN     stg_gsmac_transaction.s902%TYPE,
    inS903                  IN     stg_gsmac_transaction.s903%TYPE,
    inS904                  IN     stg_gsmac_transaction.s904%TYPE,
    inS905                  IN     stg_gsmac_transaction.s905%TYPE,
    inS906                  IN     stg_gsmac_transaction.s906%TYPE,
    inS907                  IN     stg_gsmac_transaction.s907%TYPE,
    inS908                  IN     stg_gsmac_transaction.s908%TYPE,
    inS909                  IN     stg_gsmac_transaction.s909%TYPE,
    inS90x                  IN     stg_gsmac_transaction.s90x%TYPE,
    inF25d                  IN     stg_gsmac_transaction.f25d%TYPE,
    inF24b                  IN     stg_gsmac_transaction.f24b%TYPE);

PROCEDURE sp_upd_MessageCvw
   (inMsgId                     IN     message_cvw.msg_id%TYPE,
    inMsgState                  IN     message_cvw.msg_state%TYPE);

	
/* Driver SP for SMAC_POSITION_Publish  Insert */
PROCEDURE sp_gsmac_position_publish
   (inPositionSeq	                  IN     gsmac_position_publisher.POSITION_SEQ%TYPE,
	inPosFund                         IN     gsmac_position_publisher.POS_FUND%TYPE,
	inPosSetlLoc                      IN     gsmac_position_publisher.POS_SETL_LOC%TYPE,
	inPosCusip                        IN     gsmac_position_publisher.POS_CUSIP%TYPE,
	inActTrdId                        IN     gsmac_position_publisher.ACT_TRD_ID%TYPE,
	inPosSetlAcct                     IN     gsmac_position_publisher.ACT_SETL_ACCT%TYPE,
	inSecurityId                      IN     gsmac_position_publisher.SECURITY_ID%TYPE,
	inPosTotal                        IN     gsmac_position_publisher.POS_TOTAL%TYPE,
	inSourceCorrId                    IN     gsmac_position_publisher.SOURCE_CORR_ID%TYPE); 

/*--------------------------------*/
/* ##### PROCEDURES :  End  ##### */
/*--------------------------------*/




END pkg_custody;
/


create or replace PACKAGE BODY IAL_CVW.pkg_custody
/*#################################################*/
/*            cr_PKG_CUSTODY_pkg.sql               */
/*-------------------------------------------------*/
/* SPS : 06-JUL-18 - creation                      */
/*#################################################*/

AS

/*-------------------------------*/
/* ##### FUNCTIONS : Begin ##### */
/*-------------------------------*/

FUNCTION sf_get_PositionSeq
   (inPosFund                   IN     gsmac_position.pos_fund%TYPE,
    inPosSetlLoc                IN     gsmac_position.pos_setl_loc%TYPE,
    inPosCusip                  IN     gsmac_position.pos_cusip%TYPE)  RETURN NUMBER

IS

   lv_retval         gsmac_position.position_seq%TYPE;

BEGIN

   SELECT position_seq
   INTO   lv_retval
   FROM   gsmac_position
   WHERE  pos_fund     = inPosFund
    AND   pos_setl_loc = inPosSetlLoc
    AND   pos_cusip    = inPosCusip;

   RETURN lv_retval;

EXCEPTION
   WHEN  NO_DATA_FOUND
     THEN
       /* RAISE; -- Decide action! */
       lv_retval := NULL;
       RETURN lv_retval;

END sf_get_PositionSeq;


FUNCTION sf_get_SecurityId
   (inSscSecId                  IN     IAL_OIR.security_master.ssc_sec_id%TYPE)  RETURN NUMBER

IS

   lv_retval         IAL_OIR.security_master.security_id%TYPE;

BEGIN

   SELECT security_id
   INTO   lv_retval
   FROM   IAL_OIR.security_master
   WHERE  ssc_sec_id = inSscSecId;

   RETURN lv_retval;

EXCEPTION
   WHEN  NO_DATA_FOUND
     THEN
       lv_retval := NULL;
       RETURN lv_retval;

END sf_get_SecurityId;


/*-------------------------------*/
/* ##### FUNCTIONS :  End  ##### */
/*-------------------------------*/

/*--------------------------------*/
/* ##### PROCEDURES : Begin ##### */
/*--------------------------------*/

PROCEDURE sp_Custody_Trans_01
   (inSourceCorrId              IN     message_cvw.source_corr_id%TYPE,
    inMsgType                   IN     message_cvw.msg_type%TYPE,
    inMsgSubType                IN     message_cvw.msg_sub_type%TYPE,
    inSrcSstm                   IN     message_cvw.src_sstm%TYPE,
    inDstntnSstm                IN     message_cvw.dstntn_sstm%TYPE,
    inMsgState                  IN     message_cvw.msg_state%TYPE,
    inQueueName                 IN     message_cvw.queue_name%TYPE,
    inMsgSendDttm               IN     message_cvw.msg_send_dttm%TYPE,
    inMsgRcvdDttm               IN     message_cvw.msg_rcvd_dttm%TYPE,
    inMsgVrsnNmbr               IN     message_cvw.msg_vrsn_nmbr%TYPE,
    inMsgTmstmp                 IN     message_cvw.msg_tmstmp%TYPE,
    inMsgClob                   IN     message_cvw.msg_clob%TYPE,
    inReplayFlg                 IN     message_cvw.replay_flg%TYPE,
    inReplayLgn                 IN     message_cvw.replay_lgn%TYPE,
    inReplayMsgId               IN     message_cvw.replay_msg_id%TYPE,
    inRefMsgId                  IN     message_cvw.ref_msg_id%TYPE,
    inUpdtLgn                   IN     message_cvw.updt_lgn%TYPE,
    inUpdtDttm                  IN     message_cvw.updt_dttm%TYPE,
    outMsgId                       OUT message_cvw.msg_id%TYPE)

IS

   lv_MsgId        message_cvw.msg_id%TYPE;

BEGIN

   /* Generate MSG_ID */
   SELECT seq_MsgId.NEXTVAL
   INTO   lv_MsgId
   FROM   DUAL;

   /* Process raw message */
   sp_ins_MessageCvw(lv_MsgId,
                     inSourceCorrId,
                     inMsgType,
                     inMsgSubType,
                     inSrcSstm,
                     inDstntnSstm,
                     inMsgState,
                     inQueueName,
                     inMsgSendDttm,
                     inMsgRcvdDttm,
                     inMsgVrsnNmbr,
                     inMsgTmstmp,
                     inMsgClob,
                     inReplayFlg,
                     inReplayLgn,
                     inReplayMsgId,
                     inRefMsgId,
                     inUpdtLgn,
                     inUpdtDttm);

   /* Assign MSG_ID to "out" parameter ... needed for future SP calls */
   outMsgId := lv_MsgId;

EXCEPTION
   WHEN OTHERS
      THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_Custody_Trans_01 **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_Custody_Trans_01;


PROCEDURE sp_Custody_Trans_02
   (inPosFund                   IN     gsmac_position.pos_fund%TYPE,
    inPosSetlLoc                IN     gsmac_position.pos_setl_loc%TYPE,
    inPosCusip                  IN     gsmac_position.pos_cusip%TYPE,
    inActTrdId                  IN     gsmac_position_history.act_trd_id%TYPE,  -- History table ONLY
    inSourceCorrId              IN     gsmac_position.source_corr_id%TYPE,
    inMsgId                     IN     gsmac_position.msg_id%TYPE,
    inMsgSrc                    IN     gsmac_position.msg_src%TYPE,
    inPosMatDt                  IN     gsmac_position.pos_mat_dt%TYPE,
    inPosRate                   IN     gsmac_position.pos_rate%TYPE,
    inPosSetlLocName            IN     gsmac_position.pos_setl_loc_name%TYPE,
    inPosFundName               IN     gsmac_position.pos_fund_name%TYPE,
    inPosAssetDesc              IN     gsmac_position.pos_asset_desc%TYPE,
    inAsofTradeDt               IN     gsmac_position.asof_trade_dt%TYPE,
    inAsofCsd                   IN     gsmac_position.asof_csd%TYPE,
    inAsofSafe                  IN     gsmac_position.asof_safe%TYPE,
    inAsofAvail                 IN     gsmac_position.asof_avail%TYPE,
    inAsofOutForReg             IN     gsmac_position.asof_out_for_reg%TYPE,
    inAsofReg                   IN     gsmac_position.asof_reg%TYPE,
    inAsofUnregOth              IN     gsmac_position.asof_unreg_oth%TYPE,
    inAsofUnregVol              IN     gsmac_position.asof_unreg_vol%TYPE,
    inAsofSsbBor                IN     gsmac_position.asof_ssb_bor%TYPE,
    inAsof3ptyBor               IN     gsmac_position.asof_3pty_bor%TYPE,
    inAsofSsbLoan               IN     gsmac_position.asof_ssb_loan%TYPE,
    inAsof3ptyLoan              IN     gsmac_position.asof_3pty_loan%TYPE,
    inAsofClearing              IN     gsmac_position.asof_clearing%TYPE,
    inAsofSeg                   IN     gsmac_position.asof_seg%TYPE,
    inAsofBlock                 IN     gsmac_position.asof_block%TYPE,
    inAsofRecvColl              IN     gsmac_position.asof_recv_coll%TYPE,
    inAsofDelColl               IN     gsmac_position.asof_del_coll%TYPE,
    inAsofPendRec               IN     gsmac_position.asof_pend_rec%TYPE,
    inAsofPendDel               IN     gsmac_position.asof_pend_del%TYPE,
    inAsofBear                  IN     gsmac_position.asof_bear%TYPE,
    inRefInvType                IN     gsmac_position.ref_inv_type%TYPE,
    inRefOldCusip               IN     gsmac_position.ref_old_cusip%TYPE,
    inPosSecType                IN     gsmac_position.pos_sec_type%TYPE,
    inPosIssDt                  IN     gsmac_position.pos_iss_dt%TYPE,
    inPosFundSp                 IN     gsmac_position.pos_fund_sp%TYPE,
    inPosSecsAcct               IN     gsmac_position.pos_secs_acct%TYPE,
    inPosSetlAcct               IN     gsmac_position.pos_setl_acct%TYPE,
    inPosAsofDt                 IN     gsmac_position.pos_asof_dt%TYPE,
    inPosUserId                 IN     gsmac_position.pos_user_id%TYPE,
    inPosAction                 IN     gsmac_position.pos_action%TYPE,
    inPosUserDt                 IN     gsmac_position.pos_user_dt%TYPE,
    inPosUserTm                 IN     gsmac_position.pos_user_tm%TYPE,
    inPosPgmId                  IN     gsmac_position.pos_pgm_id%TYPE,
    inPosTranCd                 IN     gsmac_position.pos_tran_cd%TYPE,
    inPosSysDt                  IN     gsmac_position.pos_sys_dt%TYPE,
    inPosSysTm                  IN     gsmac_position.pos_sys_tm%TYPE,
    inPosPostDt                 IN     gsmac_position.pos_post_dt%TYPE,
    inPosPostTm                 IN     gsmac_position.pos_post_tm%TYPE,
    inPosDttm                   IN     gsmac_position.pos_dttm%TYPE,
	inAsofPendLoanDel           IN     gsmac_position.asof_pend_loan_del%TYPE,
	inPostotal					IN     gsmac_position.pos_total%TYPE,	
    outPositionSeq                 OUT gsmac_position.position_seq%TYPE,
    outSecurityId                  OUT gsmac_position.security_id%TYPE)

IS

   lv_SecurityId     gsmac_position.security_id%TYPE;
   lv_PositionSeq    gsmac_position.position_seq%TYPE;

BEGIN

   /*---------------------------------------------------------------------------------------*/
   /* Extract SECURITY_ID from SECURITY_MASTER. Needed for Position and Transaction tables. */
   /*---------------------------------------------------------------------------------------*/
   lv_SecurityId := sf_get_SecurityId(inPosCusip);

   /*------------------------*/
   /* GSMAC_POSITION : Merge */
   /*------------------------*/
   sp_mrg_GsmacPosition(inPosFund,
                        inPosSetlLoc,
                        inPosCusip,
                        inSourceCorrId,
                        inMsgId,
                        inMsgSrc,
                        inPosMatDt,
                        inPosRate,
                        lv_SecurityId,
                        inPosSetlLocName,
                        inPosFundName,
                        inPosAssetDesc,
                        inAsofTradeDt,
                        inAsofCsd,
                        inAsofSafe,
                        inAsofAvail,
                        inAsofOutForReg,
                        inAsofReg,
                        inAsofUnregOth,
                        inAsofUnregVol,
                        inAsofSsbBor,
                        inAsof3ptyBor,
                        inAsofSsbLoan,
                        inAsof3ptyLoan,
                        inAsofClearing,
                        inAsofSeg,
                        inAsofBlock,
                        inAsofRecvColl,
                        inAsofDelColl,
                        inAsofPendRec,
                        inAsofPendDel,
                        inAsofBear,
                        inRefInvType,
                        inRefOldCusip,
                        inPosSecType,
                        inPosIssDt,
                        inPosFundSp,
                        inPosSecsAcct,
                        inPosSetlAcct,
                        inPosAsofDt,
                        inPosUserId,
                        inPosAction,
                        inPosUserDt,
                        inPosUserTm,
                        inPosPgmId,
                        inPosTranCd,
                        inPosSysDt,
                        inPosSysTm,
                        inPosPostDt,
                        inPosPostTm,
                        inPosDttm,
						inAsofPendLoanDel,
						inPostotal);

   /*----------------------------------------------------------------------------------------------------------*/
   /* Extract the POSITION_SEQ value from the GSMAC_POSITION row just Merged (above) for downstream processing */
   /*----------------------------------------------------------------------------------------------------------*/
   lv_PositionSeq := sf_get_PositionSeq(inPosFund,
                                        inPosSetlLoc,
                                        inPosCusip);

   /*---------------------------------*/
   /* GSMAC_POSITION_HISTORY : Insert */
   /*---------------------------------*/
   sp_ins_GsmacPositionHistory(inPosFund,
                               inPosSetlLoc,
                               inPosCusip,
                               inActTrdId,
                               inSourceCorrId,
                               inMsgId,
                               inMsgSrc,
                               lv_PositionSeq,   /* Derived after Position Merge */
                               inPosMatDt,
                               inPosRate,
                               lv_SecurityId,    /* Derived at beginning of SP */
                               inPosSetlLocName,
                               inPosFundName,
                               inPosAssetDesc,
                               inAsofTradeDt,
                               inAsofCsd,
                               inAsofSafe,
                               inAsofAvail,
                               inAsofOutForReg,
                               inAsofReg,
                               inAsofUnregOth,
                               inAsofUnregVol,
                               inAsofSsbBor,
                               inAsof3ptyBor,
                               inAsofSsbLoan,
                               inAsof3ptyLoan,
                               inAsofClearing,
                               inAsofSeg,
                               inAsofBlock,
                               inAsofRecvColl,
                               inAsofDelColl,
                               inAsofPendRec,
                               inAsofPendDel,
                               inAsofBear,
                               inRefInvType,
                               inRefOldCusip,
                               inPosSecType,
                               inPosIssDt,
                               inPosFundSp,
                               inPosSecsAcct,
                               inPosSetlAcct,
                               inPosAsofDt,
                               inPosUserId,
                               inPosAction,
                               inPosUserDt,
                               inPosUserTm,
                               inPosPgmId,
                               inPosTranCd,
                               inPosSysDt,
                               inPosSysTm,
                               inPosPostDt,
                               inPosPostTm,
                               inPosDttm,
							   inAsofPendLoanDel,
							   inPostotal);

   /* Assign "out" parameters ... needed for future SP calls */
   outPositionSeq := lv_PositionSeq;
   outSecurityId  := lv_SecurityId;

EXCEPTION
   WHEN OTHERS
      THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_Custody_Trans_02 **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_Custody_Trans_02;


PROCEDURE sp_Custody_Trans_03
   (inActTrdId                  IN     gsmac_transaction.act_trd_id%TYPE,
    inActTrdIdSeq               IN     gsmac_transaction.act_trd_id_seq%TYPE,
    inActStat                   IN     gsmac_transaction.act_stat%TYPE,
    inPosFund                   IN     gsmac_transaction.pos_fund%TYPE,
    inPosCusip                  IN     gsmac_transaction.pos_cusip%TYPE,
    inSourceCorrId              IN     gsmac_transaction.source_corr_id%TYPE,
    inMsgId                     IN     gsmac_transaction.msg_id%TYPE,
    inPositionSeq               IN     gsmac_transaction.position_seq%TYPE,
    inMessageSource             IN     gsmac_transaction.message_source%TYPE,
    inActMsgSrc                 IN     gsmac_transaction.act_msg_src%TYPE,
    inSecurityId                IN     gsmac_transaction.security_id%TYPE,
    inActTrdDt                  IN     gsmac_transaction.act_trd_dt%TYPE,
    inActCsd                    IN     gsmac_transaction.act_csd%TYPE,
    inActActualSetlDt           IN     gsmac_transaction.act_actual_setl_dt%TYPE,
    inPosSetlLoc                IN     gsmac_transaction.pos_setl_loc%TYPE,
    inActSetlAcct               IN     gsmac_transaction.act_setl_acct%TYPE,
    inActCurrCd                 IN     gsmac_transaction.act_curr_cd%TYPE,
    inActContShs                IN     gsmac_transaction.act_cont_shs%TYPE,
    inActActualShs              IN     gsmac_transaction.act_actual_shs%TYPE,
    inActContAmt                IN     gsmac_transaction.act_cont_amt%TYPE,
    inActNetAmt                 IN     gsmac_transaction.act_net_amt%TYPE,
    inActExecBrk                IN     gsmac_transaction.act_exec_brk%TYPE,
    inActClrngBrk               IN     gsmac_transaction.act_clrng_brk%TYPE,
    inActSysSetlDt              IN     gsmac_transaction.act_sys_setl_dt%TYPE,
    inActComment                IN     gsmac_transaction.act_comment%TYPE,
    inActNextSeq                IN     gsmac_transaction.act_next_seq%TYPE,
    inActTranType               IN     gsmac_transaction.act_tran_type%TYPE,
    inActTranQual               IN     gsmac_transaction.act_tran_qual%TYPE,
    inRefInvType                IN     gsmac_transaction.ref_inv_type%TYPE,
    inRefInvTypeDesc            IN     gsmac_transaction.ref_inv_type_desc%TYPE,
    inActRate                   IN     gsmac_transaction.act_rate%TYPE,
    inActMatDt                  IN     gsmac_transaction.act_mat_dt%TYPE,
    inActSecsAcct               IN     gsmac_transaction.act_secs_acct%TYPE,
    inActNxtDest                IN     gsmac_transaction.act_nxt_dest%TYPE,
    inActSubValDt               IN     gsmac_transaction.act_sub_val_dt%TYPE,
    inActSsbValDt               IN     gsmac_transaction.act_ssb_val_dt%TYPE,
    inActTranGrpId              IN     gsmac_transaction.act_tran_grp_id%TYPE,
    inActRelCashId              IN     gsmac_transaction.act_rel_cash_id%TYPE,
    inActIbsSeq                 IN     gsmac_transaction.act_ibs_seq%TYPE,
    inActBtchDt                 IN     gsmac_transaction.act_btch_dt%TYPE,
    inActBtchCd                 IN     gsmac_transaction.act_btch_cd%TYPE,
    inActBtchStat               IN     gsmac_transaction.act_btch_stat%TYPE,
    inActLastUser               IN     gsmac_transaction.act_last_user%TYPE,
    inActLastAction             IN     gsmac_transaction.act_last_action%TYPE,
    inActSysDt                  IN     gsmac_transaction.act_sys_dt%TYPE,
    inActSysDttm                IN     gsmac_transaction.act_sys_dttm%TYPE)

IS

BEGIN

   /*---------------------------*/
   /* GSMAC_TRANSACTION : Merge */
   /*---------------------------*/
   sp_mrg_GsmacTransaction(inActTrdId,
                           inActTrdIdSeq,
                           inActStat,
                           inPosFund,
                           inPosCusip,
                           inSourceCorrId,
                           inMsgId,
                           inPositionSeq,
                           inMessageSource,
                           inActMsgSrc,
                           inSecurityId,
                           inActTrdDt,
                           inActCsd,
                           inActActualSetlDt,
                           inPosSetlLoc,
                           inActSetlAcct,
                           inActCurrCd,
                           inActContShs,
                           inActActualShs,
                           inActContAmt,
                           inActNetAmt,
                           inActExecBrk,
                           inActClrngBrk,
                           inActSysSetlDt,
                           inActComment,
                           inActNextSeq,
                           inActTranType,
                           inActTranQual,
                           inRefInvType,
                           inRefInvTypeDesc,
                           inActRate,
                           inActMatDt,
                           inActSecsAcct,
                           inActNxtDest,
                           inActSubValDt,
                           inActSsbValDt,
                           inActTranGrpId,
                           inActRelCashId,
                           inActIbsSeq,
                           inActBtchDt,
                           inActBtchCd,
                           inActBtchStat,
                           inActLastUser,
                           inActLastAction,
                           inActSysDt,
                           inActSysDttm);

   /*------------------------------------*/
   /* GSMAC_TRANSACTION_HISTORY : Insert */
   /*------------------------------------*/
   sp_ins_GsmacTransactionHistory(inActTrdId,
                                  inActTrdIdSeq,
                                  inActStat,
                                  inPosFund,
                                  inPosCusip,
                                  inSourceCorrId,
                                  inMsgId,
                                  inPositionSeq,
                                  inMessageSource,
                                  inActMsgSrc,
                                  inSecurityId,
                                  inActTrdDt,
                                  inActCsd,
                                  inActActualSetlDt,
                                  inPosSetlLoc,
                                  inActSetlAcct,
                                  inActCurrCd,
                                  inActContShs,
                                  inActActualShs,
                                  inActContAmt,
                                  inActNetAmt,
                                  inActExecBrk,
                                  inActClrngBrk,
                                  inActSysSetlDt,
                                  inActComment,
                                  inActNextSeq,
                                  inActTranType,
                                  inActTranQual,
                                  inRefInvType,
                                  inRefInvTypeDesc,
                                  inActRate,
                                  inActMatDt,
                                  inActSecsAcct,
                                  inActNxtDest,
                                  inActSubValDt,
                                  inActSsbValDt,
                                  inActTranGrpId,
                                  inActRelCashId,
                                  inActIbsSeq,
                                  inActBtchDt,
                                  inActBtchCd,
                                  inActBtchStat,
                                  inActLastUser,
                                  inActLastAction,
                                  inActSysDt,
                                  inActSysDttm);

EXCEPTION
   WHEN OTHERS
      THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_Custody_Trans_03 **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_Custody_Trans_03;


PROCEDURE sp_ins_MessageCvw
   (inMsgId                     IN     message_cvw.msg_id%TYPE,
    inSourceCorrId              IN     message_cvw.source_corr_id%TYPE,
    inMsgType                   IN     message_cvw.msg_type%TYPE,
    inMsgSubType                IN     message_cvw.msg_sub_type%TYPE,
    inSrcSstm                   IN     message_cvw.src_sstm%TYPE,
    inDstntnSstm                IN     message_cvw.dstntn_sstm%TYPE,
    inMsgState                  IN     message_cvw.msg_state%TYPE,
    inQueueName                 IN     message_cvw.queue_name%TYPE,
    inMsgSendDttm               IN     message_cvw.msg_send_dttm%TYPE,
    inMsgRcvdDttm               IN     message_cvw.msg_rcvd_dttm%TYPE,
    inMsgVrsnNmbr               IN     message_cvw.msg_vrsn_nmbr%TYPE,
    inMsgTmstmp                 IN     message_cvw.msg_tmstmp%TYPE,
    inMsgClob                   IN     message_cvw.msg_clob%TYPE,
    inReplayFlg                 IN     message_cvw.replay_flg%TYPE,
    inReplayLgn                 IN     message_cvw.replay_lgn%TYPE,
    inReplayMsgId               IN     message_cvw.replay_msg_id%TYPE,
    inRefMsgId                  IN     message_cvw.ref_msg_id%TYPE,
    inUpdtLgn                   IN     message_cvw.updt_lgn%TYPE,
    inUpdtDttm                  IN     message_cvw.updt_dttm%TYPE)

IS


BEGIN

   /* Insert raw message */
   INSERT INTO message_cvw
     (msg_id,
      source_corr_id,
      msg_type,
      msg_sub_type,
      src_sstm,
      dstntn_sstm,
      msg_state,
      queue_name,
      msg_send_dttm,
      msg_rcvd_dttm,
      msg_vrsn_nmbr,
      msg_tmstmp,
      msg_clob,
      replay_flg,
      replay_lgn,
      replay_msg_id,
      ref_msg_id,
      updt_lgn,
      updt_dttm)
   VALUES
     (inMsgId,
      inSourceCorrId,
      inMsgType,
      inMsgSubType,
      inSrcSstm,
      inDstntnSstm,
      inMsgState,
      inQueueName,
      inMsgSendDttm,
      inMsgRcvdDttm,
      inMsgVrsnNmbr,
      inMsgTmstmp,
      inMsgClob,
      inReplayFlg,
      inReplayLgn,
      inReplayMsgId,
      inRefMsgId,
      inUpdtLgn,
      inUpdtDttm);

EXCEPTION
   WHEN OTHERS
      THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_ins_MessageCvw **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_ins_MessageCvw;


PROCEDURE sp_ins_MessageCvw
   (inSourceCorrId              IN     message_cvw.source_corr_id%TYPE,
    inMsgType                   IN     message_cvw.msg_type%TYPE,
    inMsgSubType                IN     message_cvw.msg_sub_type%TYPE,
    inSrcSstm                   IN     message_cvw.src_sstm%TYPE,
    inDstntnSstm                IN     message_cvw.dstntn_sstm%TYPE,
    inMsgState                  IN     message_cvw.msg_state%TYPE,
    inQueueName                 IN     message_cvw.queue_name%TYPE,
    inMsgSendDttm               IN     message_cvw.msg_send_dttm%TYPE,
    inMsgRcvdDttm               IN     message_cvw.msg_rcvd_dttm%TYPE,
    inMsgVrsnNmbr               IN     message_cvw.msg_vrsn_nmbr%TYPE,
    inMsgTmstmp                 IN     message_cvw.msg_tmstmp%TYPE,
    inMsgClob                   IN     message_cvw.msg_clob%TYPE,
    inReplayFlg                 IN     message_cvw.replay_flg%TYPE,
    inReplayLgn                 IN     message_cvw.replay_lgn%TYPE,
    inReplayMsgId               IN     message_cvw.replay_msg_id%TYPE,
    inRefMsgId                  IN     message_cvw.ref_msg_id%TYPE,
    inUpdtLgn                   IN     message_cvw.updt_lgn%TYPE,
    inUpdtDttm                  IN     message_cvw.updt_dttm%TYPE,
    outMsgId                       OUT message_cvw.msg_id%TYPE)

IS


BEGIN

   /* Assign MSG_ID to Out parameter (needed for future SP calls */
   SELECT seq_MsgId.NEXTVAL
   INTO   outMsgId
   FROM   DUAL;

   /* Insert raw message */
   INSERT INTO message_cvw
     (msg_id,
      source_corr_id,
      msg_type,
      msg_sub_type,
      src_sstm,
      dstntn_sstm,
      msg_state,
      queue_name,
      msg_send_dttm,
      msg_rcvd_dttm,
      msg_vrsn_nmbr,
      msg_tmstmp,
      msg_clob,
      replay_flg,
      replay_lgn,
      replay_msg_id,
      ref_msg_id,
      updt_lgn,
      updt_dttm)
   VALUES
     (outMsgId,
      inSourceCorrId,
      inMsgType,
      inMsgSubType,
      inSrcSstm,
      inDstntnSstm,
      inMsgState,
      inQueueName,
      inMsgSendDttm,
      inMsgRcvdDttm,
      inMsgVrsnNmbr,
      inMsgTmstmp,
      inMsgClob,
      inReplayFlg,
      inReplayLgn,
      inReplayMsgId,
      inRefMsgId,
      inUpdtLgn,
      inUpdtDttm);

EXCEPTION
   WHEN OTHERS
      THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_ins_MessageCvw **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_ins_MessageCvw;


PROCEDURE sp_mrg_GsmacPosition
   (inPosFund                   IN     gsmac_position.pos_fund%TYPE,
    inPosSetlLoc                IN     gsmac_position.pos_setl_loc%TYPE,
    inPosCusip                  IN     gsmac_position.pos_cusip%TYPE,
    inSourceCorrId              IN     gsmac_position.source_corr_id%TYPE,
    inMsgId                     IN     gsmac_position.msg_id%TYPE,
    inMsgSrc                    IN     gsmac_position.msg_src%TYPE,
    inPosMatDt                  IN     gsmac_position.pos_mat_dt%TYPE,
    inPosRate                   IN     gsmac_position.pos_rate%TYPE,
    inSecurityId                IN     gsmac_position.security_id%TYPE,
    inPosSetlLocName            IN     gsmac_position.pos_setl_loc_name%TYPE,
    inPosFundName               IN     gsmac_position.pos_fund_name%TYPE,
    inPosAssetDesc              IN     gsmac_position.pos_asset_desc%TYPE,
    inAsofTradeDt               IN     gsmac_position.asof_trade_dt%TYPE,
    inAsofCsd                   IN     gsmac_position.asof_csd%TYPE,
    inAsofSafe                  IN     gsmac_position.asof_safe%TYPE,
    inAsofAvail                 IN     gsmac_position.asof_avail%TYPE,
    inAsofOutForReg             IN     gsmac_position.asof_out_for_reg%TYPE,
    inAsofReg                   IN     gsmac_position.asof_reg%TYPE,
    inAsofUnregOth              IN     gsmac_position.asof_unreg_oth%TYPE,
    inAsofUnregVol              IN     gsmac_position.asof_unreg_vol%TYPE,
    inAsofSsbBor                IN     gsmac_position.asof_ssb_bor%TYPE,
    inAsof3ptyBor               IN     gsmac_position.asof_3pty_bor%TYPE,
    inAsofSsbLoan               IN     gsmac_position.asof_ssb_loan%TYPE,
    inAsof3ptyLoan              IN     gsmac_position.asof_3pty_loan%TYPE,
    inAsofClearing              IN     gsmac_position.asof_clearing%TYPE,
    inAsofSeg                   IN     gsmac_position.asof_seg%TYPE,
    inAsofBlock                 IN     gsmac_position.asof_block%TYPE,
    inAsofRecvColl              IN     gsmac_position.asof_recv_coll%TYPE,
    inAsofDelColl               IN     gsmac_position.asof_del_coll%TYPE,
    inAsofPendRec               IN     gsmac_position.asof_pend_rec%TYPE,
    inAsofPendDel               IN     gsmac_position.asof_pend_del%TYPE,
    inAsofBear                  IN     gsmac_position.asof_bear%TYPE,
    inRefInvType                IN     gsmac_position.ref_inv_type%TYPE,
    inRefOldCusip               IN     gsmac_position.ref_old_cusip%TYPE,
    inPosSecType                IN     gsmac_position.pos_sec_type%TYPE,
    inPosIssDt                  IN     gsmac_position.pos_iss_dt%TYPE,
    inPosFundSp                 IN     gsmac_position.pos_fund_sp%TYPE,
    inPosSecsAcct               IN     gsmac_position.pos_secs_acct%TYPE,
    inPosSetlAcct               IN     gsmac_position.pos_setl_acct%TYPE,
    inPosAsofDt                 IN     gsmac_position.pos_asof_dt%TYPE,
    inPosUserId                 IN     gsmac_position.pos_user_id%TYPE,
    inPosAction                 IN     gsmac_position.pos_action%TYPE,
    inPosUserDt                 IN     gsmac_position.pos_user_dt%TYPE,
    inPosUserTm                 IN     gsmac_position.pos_user_tm%TYPE,
    inPosPgmId                  IN     gsmac_position.pos_pgm_id%TYPE,
    inPosTranCd                 IN     gsmac_position.pos_tran_cd%TYPE,
    inPosSysDt                  IN     gsmac_position.pos_sys_dt%TYPE,
    inPosSysTm                  IN     gsmac_position.pos_sys_tm%TYPE,
    inPosPostDt                 IN     gsmac_position.pos_post_dt%TYPE,
    inPosPostTm                 IN     gsmac_position.pos_post_tm%TYPE,
    inPosDttm                   IN     gsmac_position.pos_dttm%TYPE,
	inAsofPendLoanDel           IN     gsmac_position.asof_pend_loan_del%TYPE,
	inPostotal					IN     gsmac_position.pos_total%TYPE)

IS

BEGIN

   /*---------------------------------------------------*/
   /* Merge passed record into the GSMAC_POSITION table */
   /*   - If Position exists, Update it.                */
   /*   - If Position does NOT exist, Insert it         */
   /*---------------------------------------------------*/
   MERGE INTO  gsmac_position  pos
        USING (SELECT inPosFund         PosFund,
                      inPosSetlLoc      PosSetlLoc,
                      inPosCusip        PosCusip,
                      inSourceCorrId    SourceCorrId,
                      inMsgId           MsgId,
                      inMsgSrc          MsgSrc,
                      inPosMatDt        PosMatDt,
                      inPosRate         PosRate,
                      inSecurityId      SecurityId,
                      inPosSetlLocName  PosSetlLocName,
                      inPosFundName     PosFundName,
                      inPosAssetDesc    PosAssetDesc,
                      inAsofTradeDt     AsofTradeDt,
                      inAsofCsd         AsofCsd,
                      inAsofSafe        AsofSafe,
                      inAsofAvail       AsofAvail,
                      inAsofOutForReg   AsofOutForReg,
                      inAsofReg         AsofReg,
                      inAsofUnregOth    AsofUnregOth,
                      inAsofUnregVol    AsofUnregVol,
                      inAsofSsbBor      AsofSsbBor,
                      inAsof3PtyBor     Asof3PtyBor,
                      inAsofSsbLoan     AsofSsbLoan,
                      inAsof3PtyLoan    Asof3PtyLoan,
                      inAsofClearing    AsofClearing,
                      inAsofSeg         AsofSeg,
                      inAsofBlock       AsofBlock,
                      inAsofRecvColl    AsofRecvColl,
                      inAsofDelColl     AsofDelColl,
                      inAsofPendRec     AsofPendRec,
                      inAsofPendDel     AsofPendDel,
                      inAsofBear        AsofBear,
                      inRefInvType      RefInvType,
                      inRefOldCusip     RefOldCusip,
                      inPosSecType      PosSecType,
                      inPosIssDt        PosIssDt,
                      inPosFundSp       PosFundSp,
                      inPosSecsAcct     PosSecsAcct,
                      inPosSetlAcct     PosSetlAcct,
                      inPosAsofDt       PosAsofDt,
                      inPosUserId       PosUserId,
                      inPosAction       PosAction,
                      inPosUserDt       PosUserDt,
                      inPosUserTm       PosUserTm,
                      inPosPgmId        PosPgmId,
                      inPosTranCd       PosTranCd,
                      inPosSysDt        PosSysDt,
                      inPosSysTm        PosSysTm,
                      inPosPostDt       PosPostDt,
                      inPosPostTm       PosPostTm,
                      inPosDttm         PosDttm,
					  inAsofPendLoanDel AsofPendLoanDel,    
					  inPostotal		Postotal 
               FROM DUAL)  rec
           ON (    pos.pos_fund     = rec.PosFund
               AND pos.pos_setl_loc = rec.PosSetlLoc
               AND pos.pos_cusip    = rec.PosCusip)
   WHEN MATCHED
     THEN
       /*--------------------------------------------------------------------------*/
       /* Update ONLY if incoming Position record is more recent than existing row */
       /*  - This accounts for receiving entries from source that are out of order */
       /*--------------------------------------------------------------------------*/
       UPDATE SET pos.source_corr_id    = rec.SourceCorrId,
                  pos.msg_id            = rec.MsgId,
                  pos.msg_src           = rec.MsgSrc,
                  pos.pos_mat_dt        = rec.PosMatDt,
                  pos.pos_rate          = rec.PosRate,
                  pos.security_id       = rec.SecurityId,
                  pos.pos_setl_loc_name = rec.PosSetlLocName,
                  pos.pos_fund_name     = rec.PosFundName,
                  pos.pos_asset_desc    = rec.PosAssetDesc,
                  pos.asof_trade_dt     = rec.AsofTradeDt,
                  pos.asof_csd          = rec.AsofCsd,
                  pos.asof_safe         = rec.AsofSafe,
                  pos.asof_avail        = rec.AsofAvail,
                  pos.asof_out_for_reg  = rec.AsofOutForReg,
                  pos.asof_reg          = rec.AsofReg,
                  pos.asof_unreg_oth    = rec.AsofUnregOth,
                  pos.asof_unreg_vol    = rec.AsofUnregVol,
                  pos.asof_ssb_bor      = rec.AsofSsbBor,
                  pos.asof_3pty_bor     = rec.Asof3ptyBor,
                  pos.asof_ssb_loan     = rec.AsofSsbLoan,
                  pos.asof_3pty_loan    = rec.Asof3ptyLoan,
                  pos.asof_clearing     = rec.AsofClearing,
                  pos.asof_seg          = rec.AsofSeg,
                  pos.asof_block        = rec.AsofBlock,
                  pos.asof_recv_coll    = rec.AsofRecvColl,
                  pos.asof_del_coll     = rec.AsofDelColl,
                  pos.asof_pend_rec     = rec.AsofPendRec,
                  pos.asof_pend_del     = rec.AsofPendDel,
                  pos.asof_bear         = rec.AsofBear,
                  pos.ref_inv_type      = rec.RefInvType,
                  pos.ref_old_cusip     = rec.RefOldCusip,
                  pos.pos_sec_type      = rec.PosSecType,
                  pos.pos_iss_dt        = rec.PosIssDt,
                  pos.pos_fund_sp       = rec.PosFundSp,
                  pos.pos_secs_acct     = rec.PosSecsAcct,
                  pos.pos_setl_acct     = rec.PosSetlAcct,
                  pos.pos_asof_dt       = rec.PosAsofDt,
                  pos.pos_user_id       = rec.PosUserId,
                  pos.pos_action        = rec.PosAction,
                  pos.pos_user_dt       = rec.PosUserDt,
                  pos.pos_user_tm       = rec.PosUserTm,
                  pos.pos_pgm_id        = rec.PosPgmId,
                  pos.pos_tran_cd       = rec.PosTranCd,
                  pos.pos_sys_dt        = rec.PosSysDt,
                  pos.pos_sys_tm        = rec.PosSysTm,
                  pos.pos_post_dt       = rec.PosPostDt,
                  pos.pos_post_tm       = rec.PosPostTm,
                  pos.pos_dttm          = rec.PosDttm,
				  pos.asof_pend_loan_del = rec.AsofPendLoanDel,
				  pos.pos_total          = rec.Postotal,
                  pos.lastmodsignon     = USER,
                  pos.lastmoddatetime   = CURRENT_TIMESTAMP
       WHERE rec.SourceCorrId > pos.source_corr_id
   WHEN NOT MATCHED
     THEN
       /*----------------------------------------------------*/
       /* New Position record encountered ... Perform Insert */
       /*----------------------------------------------------*/
       INSERT (pos_fund,
               pos_setl_loc,
               pos_cusip,
               source_corr_id,
               msg_id,
               msg_src,
               position_seq,
               pos_mat_dt,
               pos_rate,
               security_id,
               pos_setl_loc_name,
               pos_fund_name,
               pos_asset_desc,
               asof_trade_dt,
               asof_csd,
               asof_safe,
               asof_avail,
               asof_out_for_reg,
               asof_reg,
               asof_unreg_oth,
               asof_unreg_vol,
               asof_ssb_bor,
               asof_3pty_bor,
               asof_ssb_loan,
               asof_3pty_loan,
               asof_clearing,
               asof_seg,
               asof_block,
               asof_recv_coll,
               asof_del_coll,
               asof_pend_rec,
               asof_pend_del,
               asof_bear,
               ref_inv_type,
               ref_old_cusip,
               pos_sec_type,
               pos_iss_dt,
               pos_fund_sp,
               pos_secs_acct,
               pos_setl_acct,
               pos_asof_dt,
               pos_user_id,
               pos_action,
               pos_user_dt,
               pos_user_tm,
               pos_pgm_id,
               pos_tran_cd,
               pos_sys_dt,
               pos_sys_tm,
               pos_post_dt,
               pos_post_tm,
               pos_dttm,
			   asof_pend_loan_del,
			   pos_total,
               createdate,
               lastmodsignon,
               lastmoddatetime)
       VALUES
              (rec.PosFund,
               rec.PosSetlLoc,
               rec.PosCusip,
               rec.SourceCorrId,
               rec.MsgId,
               rec.MsgSrc,
               seq_PositionSeq.NEXTVAL,  /* Only upon initial Insert (NEVER updated!) */
               rec.PosMatDt,
               rec.PosRate,
               rec.SecurityId,
               rec.PosSetlLocName,
               rec.PosFundName,
               rec.PosAssetDesc,
               rec.AsofTradeDt,
               rec.AsofCsd,
               rec.AsofSafe,
               rec.AsofAvail,
               rec.AsofOutForReg,
               rec.AsofReg,
               rec.AsofUnregOth,
               rec.AsofUnregVol,
               rec.AsofSsbBor,
               rec.Asof3ptyBor,
               rec.AsofSsbLoan,
               rec.Asof3ptyLoan,
               rec.AsofClearing,
               rec.AsofSeg,
               rec.AsofBlock,
               rec.AsofRecvColl,
               rec.AsofDelColl,
               rec.AsofPendRec,
               rec.AsofPendDel,
               rec.AsofBear,
               rec.RefInvType,
               rec.RefOldCusip,
               rec.PosSecType,
               rec.PosIssDt,
               rec.PosFundSp,
               rec.PosSecsAcct,
               rec.PosSetlAcct,
               rec.PosAsofDt,
               rec.PosUserId,
               rec.PosAction,
               rec.PosUserDt,
               rec.PosUserTm,
               rec.PosPgmId,
               rec.PosTranCd,
               rec.PosSysDt,
               rec.PosSysTm,
               rec.PosPostDt,
               rec.PosPostTm,
               rec.PosDttm,
			   rec.AsofPendLoanDel,
               rec.Postotal,
			   CURRENT_DATE,
               USER,
               CURRENT_TIMESTAMP);

EXCEPTION
   WHEN OTHERS
      THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_mrg_GsmacPosition **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_mrg_GsmacPosition;


PROCEDURE sp_mrg_GsmacTransaction
   (inActTrdId                  IN     gsmac_transaction.act_trd_id%TYPE,
    inActTrdIdSeq               IN     gsmac_transaction.act_trd_id_seq%TYPE,
    inActStat                   IN     gsmac_transaction.act_stat%TYPE,
    inPosFund                   IN     gsmac_transaction.pos_fund%TYPE,
    inPosCusip                  IN     gsmac_transaction.pos_cusip%TYPE,
    inSourceCorrId              IN     gsmac_transaction.source_corr_id%TYPE,
    inMsgId                     IN     gsmac_transaction.msg_id%TYPE,
    inPositionSeq               IN     gsmac_transaction.position_seq%TYPE,
    inMessageSource             IN     gsmac_transaction.message_source%TYPE,
    inActMsgSrc                 IN     gsmac_transaction.act_msg_src%TYPE,
    inSecurityId                IN     gsmac_transaction.security_id%TYPE,
    inActTrdDt                  IN     gsmac_transaction.act_trd_dt%TYPE,
    inActCsd                    IN     gsmac_transaction.act_csd%TYPE,
    inActActualSetlDt           IN     gsmac_transaction.act_actual_setl_dt%TYPE,
    inPosSetlLoc                IN     gsmac_transaction.pos_setl_loc%TYPE,
    inActSetlAcct               IN     gsmac_transaction.act_setl_acct%TYPE,
    inActCurrCd                 IN     gsmac_transaction.act_curr_cd%TYPE,
    inActContShs                IN     gsmac_transaction.act_cont_shs%TYPE,
    inActActualShs              IN     gsmac_transaction.act_actual_shs%TYPE,
    inActContAmt                IN     gsmac_transaction.act_cont_amt%TYPE,
    inActNetAmt                 IN     gsmac_transaction.act_net_amt%TYPE,
    inActExecBrk                IN     gsmac_transaction.act_exec_brk%TYPE,
    inActClrngBrk               IN     gsmac_transaction.act_clrng_brk%TYPE,
    inActSysSetlDt              IN     gsmac_transaction.act_sys_setl_dt%TYPE,
    inActComment                IN     gsmac_transaction.act_comment%TYPE,
    inActNextSeq                IN     gsmac_transaction.act_next_seq%TYPE,
    inActTranType               IN     gsmac_transaction.act_tran_type%TYPE,
    inActTranQual               IN     gsmac_transaction.act_tran_qual%TYPE,
    inRefInvType                IN     gsmac_transaction.ref_inv_type%TYPE,
    inRefInvTypeDesc            IN     gsmac_transaction.ref_inv_type_desc%TYPE,
    inActRate                   IN     gsmac_transaction.act_rate%TYPE,
    inActMatDt                  IN     gsmac_transaction.act_mat_dt%TYPE,
    inActSecsAcct               IN     gsmac_transaction.act_secs_acct%TYPE,
    inActNxtDest                IN     gsmac_transaction.act_nxt_dest%TYPE,
    inActSubValDt               IN     gsmac_transaction.act_sub_val_dt%TYPE,
    inActSsbValDt               IN     gsmac_transaction.act_ssb_val_dt%TYPE,
    inActTranGrpId              IN     gsmac_transaction.act_tran_grp_id%TYPE,
    inActRelCashId              IN     gsmac_transaction.act_rel_cash_id%TYPE,
    inActIbsSeq                 IN     gsmac_transaction.act_ibs_seq%TYPE,
    inActBtchDt                 IN     gsmac_transaction.act_btch_dt%TYPE,
    inActBtchCd                 IN     gsmac_transaction.act_btch_cd%TYPE,
    inActBtchStat               IN     gsmac_transaction.act_btch_stat%TYPE,
    inActLastUser               IN     gsmac_transaction.act_last_user%TYPE,
    inActLastAction             IN     gsmac_transaction.act_last_action%TYPE,
    inActSysDt                  IN     gsmac_transaction.act_sys_dt%TYPE,
    inActSysDttm                IN     gsmac_transaction.act_sys_dttm%TYPE)

IS

BEGIN

   /*------------------------------------------------------*/
   /* Merge passed record into the GSMAC_TRANSACTION table */
   /*   - If Transaction exists, Update it.                */
   /*   - If Transaction does NOT exist, Insert it         */
   /*------------------------------------------------------*/
   MERGE INTO  gsmac_transaction  txn
        USING (SELECT inActTrdId             ActTrdId,
                      inActTrdIdSeq          ActTrdIdSeq,
                      inActStat              ActStat,
                      inPosFund              PosFund,
                      inPosCusip             PosCusip,
                      inSourceCorrId         SourceCorrId,
                      inMsgId                MsgId,
                      inPositionSeq          PositionSeq,
                      inMessageSource        MessageSource,
                      inActMsgSrc            ActMsgSrc,
                      inSecurityId           SecurityId,
                      inActTrdDt             ActTrdDt,
                      inActCsd               ActCsd,
                      inActActualSetlDt      ActActualSetlDt,
                      inPosSetlLoc           PosSetlLoc,
                      inActSetlAcct          ActSetlAcct,
                      inActCurrCd            ActCurrCd,
                      inActContShs           ActContShs,
                      inActActualShs         ActActualShs,
                      inActContAmt           ActContAmt,
                      inActNetAmt            ActNetAmt,
                      inActExecBrk           ActExecBrk,
                      inActClrngBrk          ActClrngBrk,
                      inActSysSetlDt         ActSysSetlDt,
                      inActComment           ActComment,
                      inActNextSeq           ActNextSeq,
                      inActTranType          ActTranType,
                      inActTranQual          ActTranQual,
                      inRefInvType           RefInvType,
                      inRefInvTypeDesc       RefInvTypeDesc,
                      inActRate              ActRate,
                      inActMatDt             ActMatDt,
                      inActSecsAcct          ActSecsAcct,
                      inActNxtDest           ActNxtDest,
                      inActSubValDt          ActSubValDt,
                      inActSsbValDt          ActSsbValDt,
                      inActTranGrpId         ActTranGrpId,
                      inActRelCashId         ActRelCashId,
                      inActIbsSeq            ActIbsSeq,
                      inActBtchDt            ActBtchDt,
                      inActBtchCd            ActBtchCd,
                      inActBtchStat          ActBtchStat,
                      inActLastUser          ActLastUser,
                      inActLastAction        ActLastAction,
                      inActSysDt             ActSysDt,
                      inActSysDttm           ActSysDttm
               FROM DUAL)  rec
           ON (    txn.act_trd_id     = rec.ActTrdId
               AND txn.act_trd_id_seq = rec.ActTrdIdSeq)
   WHEN MATCHED
     THEN
       /*-----------------------------------------------------------------------------*/
       /* Update ONLY if incoming Transaction record is more recent than existing row */
       /*  - This accounts for receiving entries from source that are out of order    */
       /*-----------------------------------------------------------------------------*/
       UPDATE SET txn.act_stat                = rec.ActStat,
                  txn.pos_fund                = rec.PosFund,
                  txn.pos_cusip               = rec.PosCusip,
                  txn.source_corr_id          = rec.SourceCorrId,
                  txn.msg_id                  = rec.MsgId,
                  txn.position_seq            = rec.PositionSeq,
                  txn.message_source          = rec.MessageSource,
                  txn.act_msg_src             = rec.ActMsgSrc,
                  txn.security_id             = rec.SecurityId,
                  txn.act_trd_dt              = rec.ActTrdDt,
                  txn.act_csd                 = rec.ActCsd,
                  txn.act_actual_setl_dt      = rec.ActActualSetlDt,
                  txn.pos_setl_loc            = rec.PosSetlLoc,
                  txn.act_setl_acct           = rec.ActSetlAcct,
                  txn.act_curr_cd             = rec.ActCurrCd,
                  txn.act_cont_shs            = rec.ActContShs,
                  txn.act_actual_shs          = rec.ActActualShs,
                  txn.act_cont_amt            = rec.ActContAmt,
                  txn.act_net_amt             = rec.ActNetAmt,
                  txn.act_exec_brk            = rec.ActExecBrk,
                  txn.act_clrng_brk           = rec.ActClrngBrk,
                  txn.act_sys_setl_dt         = rec.ActSysSetlDt,
                  txn.act_comment             = rec.ActComment,
                  txn.act_next_seq            = rec.ActNextSeq,
                  txn.act_tran_type           = rec.ActTranType,
                  txn.act_tran_qual           = rec.ActTranQual,
                  txn.ref_inv_type            = rec.RefInvType,
                  txn.ref_inv_type_desc       = rec.RefInvTypeDesc,
                  txn.act_rate                = rec.ActRate,
                  txn.act_mat_dt              = rec.ActMatDt,
                  txn.act_secs_acct           = rec.ActSecsAcct,
                  txn.act_nxt_dest            = rec.ActNxtDest,
                  txn.act_sub_val_dt          = rec.ActSubValDt,
                  txn.act_ssb_val_dt          = rec.ActSsbValDt,
                  txn.act_tran_grp_id         = rec.ActTranGrpId,
                  txn.act_rel_cash_id         = rec.ActRelCashId,
                  txn.act_ibs_seq             = rec.ActIbsSeq,
                  txn.act_btch_dt             = rec.ActBtchDt,
                  txn.act_btch_cd             = rec.ActBtchCd,
                  txn.act_btch_stat           = rec.ActBtchStat,
                  txn.act_last_user           = rec.ActLastUser,
                  txn.act_last_action         = rec.ActLastAction,
                  txn.act_sys_dt              = rec.ActSysDt,
                  txn.act_sys_dttm            = rec.ActSysDttm,
                  txn.lastmodsignon           = USER,
                  txn.lastmoddatetime         = CURRENT_TIMESTAMP
       WHERE rec.SourceCorrId > txn.source_corr_id
   WHEN NOT MATCHED
     THEN
       /*-------------------------------------------------------*/
       /* New Transaction record encountered ... Perform Insert */
       /*-------------------------------------------------------*/
       INSERT (act_trd_id,
               act_trd_id_seq,
               act_stat,
               pos_fund,
               pos_cusip,
               source_corr_id,
               msg_id,
               position_seq,
               message_source,
               act_msg_src,
               security_id,
               act_trd_dt,
               act_csd,
               act_actual_setl_dt,
               pos_setl_loc,
               act_setl_acct,
               act_curr_cd,
               act_cont_shs,
               act_actual_shs,
               act_cont_amt,
               act_net_amt,
               act_exec_brk,
               act_clrng_brk,
               act_sys_setl_dt,
               act_comment,
               act_next_seq,
               act_tran_type,
               act_tran_qual,
               ref_inv_type,
               ref_inv_type_desc,
               act_rate,
               act_mat_dt,
               act_secs_acct,
               act_nxt_dest,
               act_sub_val_dt,
               act_ssb_val_dt,
               act_tran_grp_id,
               act_rel_cash_id,
               act_ibs_seq,
               act_btch_dt,
               act_btch_cd,
               act_btch_stat,
               act_last_user,
               act_last_action,
               act_sys_dt,
               act_sys_dttm,
               createdate,
               lastmodsignon,
               lastmoddatetime)
       VALUES
              (rec.ActTrdId,
               rec.ActTrdIdSeq,
               rec.ActStat,
               rec.PosFund,
               rec.PosCusip,
               rec.SourceCorrId,
               rec.MsgId,
               rec.PositionSeq,
               rec.MessageSource,
               rec.ActMsgSrc,
               rec.SecurityId,
               rec.ActTrdDt,
               rec.ActCsd,
               rec.ActActualSetlDt,
               rec.PosSetlLoc,
               rec.ActSetlAcct,
               rec.ActCurrCd,
               rec.ActContShs,
               rec.ActActualShs,
               rec.ActContAmt,
               rec.ActNetAmt,
               rec.ActExecBrk,
               rec.ActClrngBrk,
               rec.ActSysSetlDt,
               rec.ActComment,
               rec.ActNextSeq,
               rec.ActTranType,
               rec.ActTranQual,
               rec.RefInvType,
               rec.RefInvTypeDesc,
               rec.ActRate,
               rec.ActMatDt,
               rec.ActSecsAcct,
               rec.ActNxtDest,
               rec.ActSubValDt,
               rec.ActSsbValDt,
               rec.ActTranGrpId,
               rec.ActRelCashId,
               rec.ActIbsSeq,
               rec.ActBtchDt,
               rec.ActBtchCd,
               rec.ActBtchStat,
               rec.ActLastUser,
               rec.ActLastAction,
               rec.ActSysDt,
               rec.ActSysDttm,
               CURRENT_DATE,
               USER,
               CURRENT_TIMESTAMP);

EXCEPTION
   WHEN OTHERS
      THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_mrg_GsmacTransaction **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_mrg_GsmacTransaction;


PROCEDURE sp_ins_GsmacPositionHistory
   (inPosFund                   IN     gsmac_position_history.pos_fund%TYPE,
    inPosSetlLoc                IN     gsmac_position_history.pos_setl_loc%TYPE,
    inPosCusip                  IN     gsmac_position_history.pos_cusip%TYPE,
    inActTrdId                  IN     gsmac_position_history.act_trd_id%TYPE,
    inSourceCorrId              IN     gsmac_position_history.source_corr_id%TYPE,
    inMsgId                     IN     gsmac_position_history.msg_id%TYPE,
    inMsgSrc                    IN     gsmac_position_history.msg_src%TYPE,
    inPositionSeq               IN     gsmac_position_history.position_seq%TYPE,
    inPosMatDt                  IN     gsmac_position_history.pos_mat_dt%TYPE,
    inPosRate                   IN     gsmac_position_history.pos_rate%TYPE,
    inSecurityId                IN     gsmac_position_history.security_id%TYPE,
    inPosSetlLocName            IN     gsmac_position_history.pos_setl_loc_name%TYPE,
    inPosFundName               IN     gsmac_position_history.pos_fund_name%TYPE,
    inPosAssetDesc              IN     gsmac_position_history.pos_asset_desc%TYPE,
    inAsofTradeDt               IN     gsmac_position_history.asof_trade_dt%TYPE,
    inAsofCsd                   IN     gsmac_position_history.asof_csd%TYPE,
    inAsofSafe                  IN     gsmac_position_history.asof_safe%TYPE,
    inAsofAvail                 IN     gsmac_position_history.asof_avail%TYPE,
    inAsofOutForReg             IN     gsmac_position_history.asof_out_for_reg%TYPE,
    inAsofReg                   IN     gsmac_position_history.asof_reg%TYPE,
    inAsofUnregOth              IN     gsmac_position_history.asof_unreg_oth%TYPE,
    inAsofUnregVol              IN     gsmac_position_history.asof_unreg_vol%TYPE,
    inAsofSsbBor                IN     gsmac_position_history.asof_ssb_bor%TYPE,
    inAsof3PtyBor               IN     gsmac_position_history.asof_3pty_bor%TYPE,
    inAsofSsbLoan               IN     gsmac_position_history.asof_ssb_loan%TYPE,
    inAsof3PtyLoan              IN     gsmac_position_history.asof_3pty_loan%TYPE,
    inAsofClearing              IN     gsmac_position_history.asof_clearing%TYPE,
    inAsofSeg                   IN     gsmac_position_history.asof_seg%TYPE,
    inAsofBlock                 IN     gsmac_position_history.asof_block%TYPE,
    inAsofRecvColl              IN     gsmac_position_history.asof_recv_coll%TYPE,
    inAsofDelColl               IN     gsmac_position_history.asof_del_coll%TYPE,
    inAsofPendRec               IN     gsmac_position_history.asof_pend_rec%TYPE,
    inAsofPendDel               IN     gsmac_position_history.asof_pend_del%TYPE,
    inAsofBear                  IN     gsmac_position_history.asof_bear%TYPE,
    inRefInvType                IN     gsmac_position_history.ref_inv_type%TYPE,
    inRefOldCusip               IN     gsmac_position_history.ref_old_cusip%TYPE,
    inPosSecType                IN     gsmac_position_history.pos_sec_type%TYPE,
    inPosIssDt                  IN     gsmac_position_history.pos_iss_dt%TYPE,
    inPosFundSp                 IN     gsmac_position_history.pos_fund_sp%TYPE,
    inPosSecsAcct               IN     gsmac_position_history.pos_secs_acct%TYPE,
    inPosSetlAcct               IN     gsmac_position_history.pos_setl_acct%TYPE,
    inPosAsofDt                 IN     gsmac_position_history.pos_asof_dt%TYPE,
    inPosUserId                 IN     gsmac_position_history.pos_user_id%TYPE,
    inPosAction                 IN     gsmac_position_history.pos_action%TYPE,
    inPosUserDt                 IN     gsmac_position_history.pos_user_dt%TYPE,
    inPosUserTm                 IN     gsmac_position_history.pos_user_tm%TYPE,
    inPosPgmId                  IN     gsmac_position_history.pos_pgm_id%TYPE,
    inPosTranCd                 IN     gsmac_position_history.pos_tran_cd%TYPE,
    inPosSysDt                  IN     gsmac_position_history.pos_sys_dt%TYPE,
    inPosSysTm                  IN     gsmac_position_history.pos_sys_tm%TYPE,
    inPosPostDt                 IN     gsmac_position_history.pos_post_dt%TYPE,
    inPosPostTm                 IN     gsmac_position_history.pos_post_tm%TYPE,
    inPosDttm                   IN     gsmac_position_history.pos_dttm%TYPE,
	inAsofPendLoanDel           IN     gsmac_position_history.asof_pend_loan_del%TYPE,
	inPostotal					IN     gsmac_position_history.pos_total%TYPE)

IS

BEGIN

   INSERT INTO gsmac_position_history
      (pos_fund,
       pos_setl_loc,
       pos_cusip,
       act_trd_id,
       source_corr_id,
       msg_id,
       msg_src,
       position_seq,
       pos_mat_dt,
       pos_rate,
       security_id,
       pos_setl_loc_name,
       pos_fund_name,
       pos_asset_desc,
       asof_trade_dt,
       asof_csd,
       asof_safe,
       asof_avail,
       asof_out_for_reg,
       asof_reg,
       asof_unreg_oth,
       asof_unreg_vol,
       asof_ssb_bor,
       asof_3pty_bor,
       asof_ssb_loan,
       asof_3pty_loan,
       asof_clearing,
       asof_seg,
       asof_block,
       asof_recv_coll,
       asof_del_coll,
       asof_pend_rec,
       asof_pend_del,
       asof_bear,
       ref_inv_type,
       ref_old_cusip,
       pos_sec_type,
       pos_iss_dt,
       pos_fund_sp,
       pos_secs_acct,
       pos_setl_acct,
       pos_asof_dt,
       pos_user_id,
       pos_action,
       pos_user_dt,
       pos_user_tm,
       pos_pgm_id,
       pos_tran_cd,
       pos_sys_dt,
       pos_sys_tm,
       pos_post_dt,
       pos_post_tm,
       pos_dttm,
	   asof_pend_loan_del,
       pos_total,
	   createdate,
       lastmodsignon,
       lastmoddatetime)
   VALUES
      (inPosFund,
       inPosSetlLoc,
       inPosCusip,
       inActTrdId,
       inSourceCorrId,
       inMsgId,
       inMsgSrc,
       inPositionSeq,
       inPosMatDt,
       inPosRate,
       inSecurityId,
       inPosSetlLocName,
       inPosFundName,
       inPosAssetDesc,
       inAsofTradeDt,
       inAsofCsd,
       inAsofSafe,
       inAsofAvail,
       inAsofOutForReg,
       inAsofReg,
       inAsofUnregOth,
       inAsofUnregVol,
       inAsofSsbBor,
       inAsof3ptyBor,
       inAsofSsbLoan,
       inAsof3ptyLoan,
       inAsofClearing,
       inAsofSeg,
       inAsofBlock,
       inAsofRecvColl,
       inAsofDelColl,
       inAsofPendRec,
       inAsofPendDel,
       inAsofBear,
       inRefInvType,
       inRefOldCusip,
       inPosSecType,
       inPosIssDt,
       inPosFundSp,
       inPosSecsAcct,
       inPosSetlAcct,
       inPosAsofDt,
       inPosUserId,
       inPosAction,
       inPosUserDt,
       inPosUserTm,
       inPosPgmId,
       inPosTranCd,
       inPosSysDt,
       inPosSysTm,
       inPosPostDt,
       inPosPostTm,
       inPosDttm,
	   inAsofPendLoanDel,
       inPostotal,
	   CURRENT_DATE,
       USER,
       CURRENT_TIMESTAMP);

EXCEPTION
   WHEN  OTHERS
      THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_mrg_GsmacPositionHistory **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_ins_GsmacPositionHistory;


PROCEDURE sp_ins_GsmacTransactionHistory
   (inActTrdId                  IN     gsmac_transaction_history.act_trd_id%TYPE,
    inActTrdIdSeq               IN     gsmac_transaction_history.act_trd_id_seq%TYPE,
    inActStat                   IN     gsmac_transaction_history.act_stat%TYPE,
    inPosFund                   IN     gsmac_transaction_history.pos_fund%TYPE,
    inPosCusip                  IN     gsmac_transaction_history.pos_cusip%TYPE,
    inSourceCorrId              IN     gsmac_transaction_history.source_corr_id%TYPE,
    inMsgId                     IN     gsmac_transaction_history.msg_id%TYPE,
    inPositionSeq               IN     gsmac_transaction_history.position_seq%TYPE,
    inMessageSource             IN     gsmac_transaction_history.message_source%TYPE,
    inActMsgSrc                 IN     gsmac_transaction_history.act_msg_src%TYPE,
    inSecurityId                IN     gsmac_transaction_history.security_id%TYPE,
    inActTrdDt                  IN     gsmac_transaction_history.act_trd_dt%TYPE,
    inActCsd                    IN     gsmac_transaction_history.act_csd%TYPE,
    inActActualSetlDt           IN     gsmac_transaction_history.act_actual_setl_dt%TYPE,
    inPosSetlLoc                IN     gsmac_transaction_history.pos_setl_loc%TYPE,
    inActSetlAcct               IN     gsmac_transaction_history.act_setl_acct%TYPE,
    inActCurrCd                 IN     gsmac_transaction_history.act_curr_cd%TYPE,
    inActContShs                IN     gsmac_transaction_history.act_cont_shs%TYPE,
    inActActualShs              IN     gsmac_transaction_history.act_actual_shs%TYPE,
    inActContAmt                IN     gsmac_transaction_history.act_cont_amt%TYPE,
    inActNetAmt                 IN     gsmac_transaction_history.act_net_amt%TYPE,
    inActExecBrk                IN     gsmac_transaction_history.act_exec_brk%TYPE,
    inActClrngBrk               IN     gsmac_transaction_history.act_clrng_brk%TYPE,
    inActSysSetlDt              IN     gsmac_transaction_history.act_sys_setl_dt%TYPE,
    inActComment                IN     gsmac_transaction_history.act_comment%TYPE,
    inActNextSeq                IN     gsmac_transaction_history.act_next_seq%TYPE,
    inActTranType               IN     gsmac_transaction_history.act_tran_type%TYPE,
    inActTranQual               IN     gsmac_transaction_history.act_tran_qual%TYPE,
    inRefInvType                IN     gsmac_transaction_history.ref_inv_type%TYPE,
    inRefInvTypeDesc            IN     gsmac_transaction_history.ref_inv_type_desc%TYPE,
    inActRate                   IN     gsmac_transaction_history.act_rate%TYPE,
    inActMatDt                  IN     gsmac_transaction_history.act_mat_dt%TYPE,
    inActSecsAcct               IN     gsmac_transaction_history.act_secs_acct%TYPE,
    inActNxtDest                IN     gsmac_transaction_history.act_nxt_dest%TYPE,
    inActSubValDt               IN     gsmac_transaction_history.act_sub_val_dt%TYPE,
    inActSsbValDt               IN     gsmac_transaction_history.act_ssb_val_dt%TYPE,
    inActTranGrpId              IN     gsmac_transaction_history.act_tran_grp_id%TYPE,
    inActRelCashId              IN     gsmac_transaction_history.act_rel_cash_id%TYPE,
    inActIbsSeq                 IN     gsmac_transaction_history.act_ibs_seq%TYPE,
    inActBtchDt                 IN     gsmac_transaction_history.act_btch_dt%TYPE,
    inActBtchCd                 IN     gsmac_transaction_history.act_btch_cd%TYPE,
    inActBtchStat               IN     gsmac_transaction_history.act_btch_stat%TYPE,
    inActLastUser               IN     gsmac_transaction_history.act_last_user%TYPE,
    inActLastAction             IN     gsmac_transaction_history.act_last_action%TYPE,
    inActSysDt                  IN     gsmac_transaction_history.act_sys_dt%TYPE,
    inActSysDttm                IN     gsmac_transaction_history.act_sys_dttm%TYPE)

IS

BEGIN

   INSERT INTO gsmac_transaction_history
      (act_trd_id,
       act_trd_id_seq,
       act_stat,
       pos_fund,
       pos_cusip,
       source_corr_id,
       msg_id,
       position_seq,
       message_source,
       act_msg_src,
       security_id,
       act_trd_dt,
       act_csd,
       act_actual_setl_dt,
       pos_setl_loc,
       act_setl_acct,
       act_curr_cd,
       act_cont_shs,
       act_actual_shs,
       act_cont_amt,
       act_net_amt,
       act_exec_brk,
       act_clrng_brk,
       act_sys_setl_dt,
       act_comment,
       act_next_seq,
       act_tran_type,
       act_tran_qual,
       ref_inv_type,
       ref_inv_type_desc,
       act_rate,
       act_mat_dt,
       act_secs_acct,
       act_nxt_dest,
       act_sub_val_dt,
       act_ssb_val_dt,
       act_tran_grp_id,
       act_rel_cash_id,
       act_ibs_seq,
       act_btch_dt,
       act_btch_cd,
       act_btch_stat,
       act_last_user,
       act_last_action,
       act_sys_dt,
       act_sys_dttm,
       createdate,
       lastmodsignon,
       lastmoddatetime)
   VALUES
      (inActTrdId,
       inActTrdIdSeq,
       inActStat,
       inPosFund,
       inPosCusip,
       inSourceCorrId,
       inMsgId,
       inPositionSeq,
       inMessageSource,
       inActMsgSrc,
       inSecurityId,
       inActTrdDt,
       inActCsd,
       inActActualSetlDt,
       inPosSetlLoc,
       inActSetlAcct,
       inActCurrCd,
       inActContShs,
       inActActualShs,
       inActContAmt,
       inActNetAmt,
       inActExecBrk,
       inActClrngBrk,
       inActSysSetlDt,
       inActComment,
       inActNextSeq,
       inActTranType,
       inActTranQual,
       inRefInvType,
       inRefInvTypeDesc,
       inActRate,
       inActMatDt,
       inActSecsAcct,
       inActNxtDest,
       inActSubValDt,
       inActSsbValDt,
       inActTranGrpId,
       inActRelCashId,
       inActIbsSeq,
       inActBtchDt,
       inActBtchCd,
       inActBtchStat,
       inActLastUser,
       inActLastAction,
       inActSysDt,
       inActSysDttm,
       CURRENT_DATE,
       USER,
       CURRENT_TIMESTAMP);

EXCEPTION
   WHEN  OTHERS
      THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_mrg_GsmacTransactionHistory **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_ins_GsmacTransactionHistory;


PROCEDURE sp_ins_StgGsmacPosition
   (inMsgId                 IN     stg_gsmac_position.msg_id%TYPE,
    inF20                   IN     stg_gsmac_position.f20%TYPE,
    inPosSetlLoc            IN     stg_gsmac_position.pos_setl_loc%TYPE,
    inPosSecsAcct           IN     stg_gsmac_position.pos_secs_acct%TYPE,
    inPosSetlAcct           IN     stg_gsmac_position.pos_setl_acct%TYPE,
    inPosCusip              IN     stg_gsmac_position.pos_cusip%TYPE,
    inPosMatDt              IN     stg_gsmac_position.pos_mat_dt%TYPE,
    inPosRate               IN     stg_gsmac_position.pos_rate%TYPE,
    inPosSecType            IN     stg_gsmac_position.pos_sec_type%TYPE,
    inPosIssDt              IN     stg_gsmac_position.pos_iss_dt%TYPE,
    inPosFund               IN     stg_gsmac_position.pos_fund%TYPE,
    inPosFundSp             IN     stg_gsmac_position.pos_fund_sp%TYPE,
    inPosAsofDt             IN     stg_gsmac_position.pos_asof_dt%TYPE,
    inAsofTradeDt           IN     stg_gsmac_position.asof_trade_dt%TYPE,
    inAsofCsd               IN     stg_gsmac_position.asof_csd%TYPE,
    inAsofSafe              IN     stg_gsmac_position.asof_safe%TYPE,
    inAsofAvail             IN     stg_gsmac_position.asof_avail%TYPE,
    inAsofOutForReg         IN     stg_gsmac_position.asof_out_for_reg%TYPE,
    inAsofReg               IN     stg_gsmac_position.asof_reg%TYPE,
    inAsofUnregOth          IN     stg_gsmac_position.asof_unreg_oth%TYPE,
    inAsofUnregVol          IN     stg_gsmac_position.asof_unreg_vol%TYPE,
    inAsofSsbBor            IN     stg_gsmac_position.asof_ssb_bor%TYPE,
    inAsof3ptyBor           IN     stg_gsmac_position.asof_3pty_bor%TYPE,
    inAsofSsbLoan           IN     stg_gsmac_position.asof_ssb_loan%TYPE,
    inAsof3ptyLoan          IN     stg_gsmac_position.asof_3pty_loan%TYPE,
    inAsofClearing          IN     stg_gsmac_position.asof_clearing%TYPE,
    inAsofSeg               IN     stg_gsmac_position.asof_seg%TYPE,
    inAsofBlock             IN     stg_gsmac_position.asof_block%TYPE,
    inAsofRecvColl          IN     stg_gsmac_position.asof_recv_coll%TYPE,
    inAsofDelColl           IN     stg_gsmac_position.asof_del_coll%TYPE,
    inAsofPendRec           IN     stg_gsmac_position.asof_pend_rec%TYPE,
    inAsofPendDel           IN     stg_gsmac_position.asof_pend_del%TYPE,
    inHistTradeDt           IN     stg_gsmac_position.hist_trade_dt%TYPE,
    inHistCsd               IN     stg_gsmac_position.hist_csd%TYPE,
    inHistSafe              IN     stg_gsmac_position.hist_safe%TYPE,
    inHistAvail             IN     stg_gsmac_position.hist_avail%TYPE,
    inHistOutForReg         IN     stg_gsmac_position.hist_out_for_reg%TYPE,
    inHistReg               IN     stg_gsmac_position.hist_reg%TYPE,
    inHistUnregOth          IN     stg_gsmac_position.hist_unreg_oth%TYPE,
    inHistUnregVol          IN     stg_gsmac_position.hist_unreg_vol%TYPE,
    inHistSsbBor            IN     stg_gsmac_position.hist_ssb_bor%TYPE,
    inHist3ptyBor           IN     stg_gsmac_position.hist_3pty_bor%TYPE,
    inHistSsbLoan           IN     stg_gsmac_position.hist_ssb_loan%TYPE,
    inHist3ptyLoan          IN     stg_gsmac_position.hist_3pty_loan%TYPE,
    inHistClearing          IN     stg_gsmac_position.hist_clearing%TYPE,
    inHistSeg               IN     stg_gsmac_position.hist_seg%TYPE,
    inHistBlock             IN     stg_gsmac_position.hist_block%TYPE,
    inHistRecvColl          IN     stg_gsmac_position.hist_recv_coll%TYPE,
    inHistDelColl           IN     stg_gsmac_position.hist_del_coll%TYPE,
    inHistPendRec           IN     stg_gsmac_position.hist_pend_rec%TYPE,
    inHistPendDel           IN     stg_gsmac_position.hist_pend_del%TYPE,
    inAsofBear              IN     stg_gsmac_position.asof_bear%TYPE,
    inHistBear              IN     stg_gsmac_position.hist_bear%TYPE,
    inPosUserId             IN     stg_gsmac_position.pos_user_id%TYPE,
    inPosAction             IN     stg_gsmac_position.pos_action%TYPE,
    inPosUserDt             IN     stg_gsmac_position.pos_user_dt%TYPE,
    inPosUserTm             IN     stg_gsmac_position.pos_user_tm%TYPE,
    inPosPgmId              IN     stg_gsmac_position.pos_pgm_id%TYPE,
    inPosTranCd             IN     stg_gsmac_position.pos_tran_cd%TYPE,
    inPosSysDt              IN     stg_gsmac_position.pos_sys_dt%TYPE,
    inPosSysTm              IN     stg_gsmac_position.pos_sys_tm%TYPE,
    inPosPostDt             IN     stg_gsmac_position.pos_post_dt%TYPE,
    inPosPostTm             IN     stg_gsmac_position.pos_post_tm%TYPE,
    inPosDttm               IN     stg_gsmac_position.pos_dttm%TYPE)

IS

BEGIN

   /* Insert flattened GSMAC Position message */
   INSERT INTO stg_gsmac_position
     (msg_id,
      f20,
      pos_setl_loc,
      pos_secs_acct,
      pos_setl_acct,
      pos_cusip,
      pos_mat_dt,
      pos_rate,
      pos_sec_type,
      pos_iss_dt,
      pos_fund,
      pos_fund_sp,
      pos_asof_dt,
      asof_trade_dt,
      asof_csd,
      asof_safe,
      asof_avail,
      asof_out_for_reg,
      asof_reg,
      asof_unreg_oth,
      asof_unreg_vol,
      asof_ssb_bor,
      asof_3pty_bor,
      asof_ssb_loan,
      asof_3pty_loan,
      asof_clearing,
      asof_seg,
      asof_block,
      asof_recv_coll,
      asof_del_coll,
      asof_pend_rec,
      asof_pend_del,
      hist_trade_dt,
      hist_csd,
      hist_safe,
      hist_avail,
      hist_out_for_reg,
      hist_reg,
      hist_unreg_oth,
      hist_unreg_vol,
      hist_ssb_bor,
      hist_3pty_bor,
      hist_ssb_loan,
      hist_3pty_loan,
      hist_clearing,
      hist_seg,
      hist_block,
      hist_recv_coll,
      hist_del_coll,
      hist_pend_rec,
      hist_pend_del,
      asof_bear,
      hist_bear,
      pos_user_id,
      pos_action,
      pos_user_dt,
      pos_user_tm,
      pos_pgm_id,
      pos_tran_cd,
      pos_sys_dt,
      pos_sys_tm,
      pos_post_dt,
      pos_post_tm,
      pos_dttm)
   VALUES
     (inMsgId,
      inF20,
      inPosSetlLoc,
      inPosSecsAcct,
      inPosSetlAcct,
      inPosCusip,
      inPosMatDt,
      inPosRate,
      inPosSecType,
      inPosIssDt,
      inPosFund,
      inPosFundSp,
      inPosAsofDt,
      inAsofTradeDt,
      inAsofCsd,
      inAsofSafe,
      inAsofAvail,
      inAsofOutForReg,
      inAsofReg,
      inAsofUnregOth,
      inAsofUnregVol,
      inAsofSsbBor,
      inAsof3ptyBor,
      inAsofSsbLoan,
      inAsof3ptyLoan,
      inAsofClearing,
      inAsofSeg,
      inAsofBlock,
      inAsofRecvColl,
      inAsofDelColl,
      inAsofPendRec,
      inAsofPendDel,
      inHistTradeDt,
      inHistCsd,
      inHistSafe,
      inHistAvail,
      inHistOutForReg,
      inHistReg,
      inHistUnregOth,
      inHistUnregVol,
      inHistSsbBor,
      inHist3ptyBor,
      inHistSsbLoan,
      inHist3ptyLoan,
      inHistClearing,
      inHistSeg,
      inHistBlock,
      inHistRecvColl,
      inHistDelColl,
      inHistPendRec,
      inHistPendDel,
      inAsofBear,
      inHistBear,
      inPosUserId,
      inPosAction,
      inPosUserDt,
      inPosUserTm,
      inPosPgmId,
      inPosTranCd,
      inPosSysDt,
      inPosSysTm,
      inPosPostDt,
      inPosPostTm,
      inPosDttm);

EXCEPTION
   WHEN OTHERS
      THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_ins_StgGsmacPosition **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_ins_StgGsmacPosition;


PROCEDURE sp_ins_StgGsmacTransaction
   (inMsgId                 IN     stg_gsmac_transaction.msg_id%TYPE,
    inF20                   IN     stg_gsmac_transaction.f20%TYPE,
    inTopic                 IN     stg_gsmac_transaction.topic%TYPE,
    inVersion               IN     stg_gsmac_transaction.version%TYPE,
    inMt599Sequence         IN     stg_gsmac_transaction.mt599_sequence%TYPE,
    inF28                   IN     stg_gsmac_transaction.f28%TYPE,
    inF83a                  IN     stg_gsmac_transaction.f83a%TYPE,
    inF67a                  IN     stg_gsmac_transaction.f67a%TYPE,
    inF98a                  IN     stg_gsmac_transaction.f98a%TYPE,
    inF99a                  IN     stg_gsmac_transaction.f99a%TYPE,
    inD99                   IN     stg_gsmac_transaction.d99%TYPE,
    inF35b                  IN     stg_gsmac_transaction.f35b%TYPE,
    inF35a                  IN     stg_gsmac_transaction.f35a%TYPE,
    inF66a                  IN     stg_gsmac_transaction.f66a%TYPE,
    inF30                   IN     stg_gsmac_transaction.f30%TYPE,
    inF34a                  IN     stg_gsmac_transaction.f34a%TYPE,
    inF18a                  IN     stg_gsmac_transaction.f18a%TYPE,
    inRefCusip              IN     stg_gsmac_transaction.ref_cusip%TYPE,
    inRefTicker             IN     stg_gsmac_transaction.ref_ticker%TYPE,
    inRefInvType            IN     stg_gsmac_transaction.ref_inv_type%TYPE,
    inRefInvTypeDesc        IN     stg_gsmac_transaction.ref_inv_type_desc%TYPE,
    inRefIssueName          IN     stg_gsmac_transaction.ref_issue_name%TYPE,
    inRefIssueDesc          IN     stg_gsmac_transaction.ref_issue_desc%TYPE,
    inRefRate               IN     stg_gsmac_transaction.ref_rate%TYPE,
    inRefMatDt              IN     stg_gsmac_transaction.ref_mat_dt%TYPE,
    inRefAsstCls            IN     stg_gsmac_transaction.ref_asst_cls%TYPE,
    inRefNraTxctry          IN     stg_gsmac_transaction.ref_nra_txctry%TYPE,
    inRefGvtPoolNo          IN     stg_gsmac_transaction.ref_gvt_pool_no%TYPE,
    inRefOldCusip           IN     stg_gsmac_transaction.ref_old_cusip%TYPE,
    inRefJgbSw              IN     stg_gsmac_transaction.ref_jgb_sw%TYPE,
    inRefRednmSw            IN     stg_gsmac_transaction.ref_rednm_sw%TYPE,
    inRefEuroHistSw         IN     stg_gsmac_transaction.ref_euro_hist_sw%TYPE,
    inRefVarRtSw            IN     stg_gsmac_transaction.ref_var_rt_sw%TYPE,
    inActFund               IN     stg_gsmac_transaction.act_fund%TYPE,
    inActClRef              IN     stg_gsmac_transaction.act_cl_ref%TYPE,
    inActCusip              IN     stg_gsmac_transaction.act_cusip%TYPE,
    inActMatDt              IN     stg_gsmac_transaction.act_mat_dt%TYPE,
    inActRate               IN     stg_gsmac_transaction.act_rate%TYPE,
    inActSecTyp             IN     stg_gsmac_transaction.act_sec_typ%TYPE,
    inActIssDt              IN     stg_gsmac_transaction.act_iss_dt%TYPE,
    inActTrdId              IN     stg_gsmac_transaction.act_trd_id%TYPE,
    inActTrdIdSeq           IN     stg_gsmac_transaction.act_trd_id_seq%TYPE,
    inActTranType           IN     stg_gsmac_transaction.act_tran_type%TYPE,
    inActTranQual           IN     stg_gsmac_transaction.act_tran_qual%TYPE,
    inActTrdDt              IN     stg_gsmac_transaction.act_trd_dt%TYPE,
    inActCsd                IN     stg_gsmac_transaction.act_csd%TYPE,
    inActContShs            IN     stg_gsmac_transaction.act_cont_shs%TYPE,
    inActOrigFace           IN     stg_gsmac_transaction.act_orig_face%TYPE,
    inActContAmt            IN     stg_gsmac_transaction.act_cont_amt%TYPE,
    inActCurrCd             IN     stg_gsmac_transaction.act_curr_cd%TYPE,
    inActPmtMeth            IN     stg_gsmac_transaction.act_pmt_meth%TYPE,
    inActExecBrk            IN     stg_gsmac_transaction.act_exec_brk%TYPE,
    inActClrngBrk           IN     stg_gsmac_transaction.act_clrng_brk%TYPE,
    inActClrngBnk           IN     stg_gsmac_transaction.act_clrng_bnk%TYPE,
    inActRelTrdId           IN     stg_gsmac_transaction.act_rel_trd_id%TYPE,
    inActRelTrdIdSeq        IN     stg_gsmac_transaction.act_rel_trd_id_seq%TYPE,
    inActCorpActnId         IN     stg_gsmac_transaction.act_corp_actn_id%TYPE,
    inActSetlLoc            IN     stg_gsmac_transaction.act_setl_loc%TYPE,
    inActSetlAcct           IN     stg_gsmac_transaction.act_setl_acct%TYPE,
    inActSecsAcct           IN     stg_gsmac_transaction.act_secs_acct%TYPE,
    inActSetLocRef          IN     stg_gsmac_transaction.act_set_loc_ref%TYPE,
    inActFullPart           IN     stg_gsmac_transaction.act_full_part%TYPE,
    inActStlLvl             IN     stg_gsmac_transaction.act_stl_lvl%TYPE,
    inActActualShs          IN     stg_gsmac_transaction.act_actual_shs%TYPE,
    inActNetAmt             IN     stg_gsmac_transaction.act_net_amt%TYPE,
    inActCommShs            IN     stg_gsmac_transaction.act_comm_shs%TYPE,
    inActActualSetlDt       IN     stg_gsmac_transaction.act_actual_setl_dt%TYPE,
    inActSysSetlDt          IN     stg_gsmac_transaction.act_sys_setl_dt%TYPE,
    inActTranIdTyp          IN     stg_gsmac_transaction.act_tran_id_typ%TYPE,
    inActTranGrpId          IN     stg_gsmac_transaction.act_tran_grp_id%TYPE,
    inActRelCashId          IN     stg_gsmac_transaction.act_rel_cash_id%TYPE,
    inActRelCashSeq         IN     stg_gsmac_transaction.act_rel_cash_seq%TYPE,
    inActRelCashLnk         IN     stg_gsmac_transaction.act_rel_cash_lnk%TYPE,
    inActBtchDt             IN     stg_gsmac_transaction.act_btch_dt%TYPE,
    inActBtchCd             IN     stg_gsmac_transaction.act_btch_cd%TYPE,
    inActBtchStat           IN     stg_gsmac_transaction.act_btch_stat%TYPE,
    inActNextSeq            IN     stg_gsmac_transaction.act_next_seq%TYPE,
    inActEuclidTyp          IN     stg_gsmac_transaction.act_euclid_typ%TYPE,
    inActEuclidPri          IN     stg_gsmac_transaction.act_euclid_pri%TYPE,
    inActSwMsgPri           IN     stg_gsmac_transaction.act_sw_msg_pri%TYPE,
    inActSwMsgStat          IN     stg_gsmac_transaction.act_sw_msg_stat%TYPE,
    inActRegReq             IN     stg_gsmac_transaction.act_reg_req%TYPE,
    inActNxtDest            IN     stg_gsmac_transaction.act_nxt_dest%TYPE,
    inActEventTyp           IN     stg_gsmac_transaction.act_event_typ%TYPE,
    inActRptDt              IN     stg_gsmac_transaction.act_rpt_dt%TYPE,
    inActIscuRptDt          IN     stg_gsmac_transaction.act_iscu_rpt_dt%TYPE,
    inActEtaDt              IN     stg_gsmac_transaction.act_eta_dt%TYPE,
    inActFailRsn            IN     stg_gsmac_transaction.act_fail_rsn%TYPE,
    inActRsn                IN     stg_gsmac_transaction.act_rsn%TYPE,
    inActPshsRsn            IN     stg_gsmac_transaction.act_pshs_rsn%TYPE,
    inActFailDt             IN     stg_gsmac_transaction.act_fail_dt%TYPE,
    inActRegShs             IN     stg_gsmac_transaction.act_reg_shs%TYPE,
    inActUnregShs           IN     stg_gsmac_transaction.act_unreg_shs%TYPE,
    inActUnregFor           IN     stg_gsmac_transaction.act_unreg_for%TYPE,
    inActRegAffAvl          IN     stg_gsmac_transaction.act_reg_aff_avl%TYPE,
    inActTrddtUpd           IN     stg_gsmac_transaction.act_trddt_upd%TYPE,
    inActRecDel             IN     stg_gsmac_transaction.act_rec_del%TYPE,
    inActStat               IN     stg_gsmac_transaction.act_stat%TYPE,
    inActComment            IN     stg_gsmac_transaction.act_comment%TYPE,
    inActFfPrtDt            IN     stg_gsmac_transaction.act_ff_prt_dt%TYPE,
    inActFfDomn             IN     stg_gsmac_transaction.act_ff_domn%TYPE,
    inActFfSeq              IN     stg_gsmac_transaction.act_ff_seq%TYPE,
    inActFfRprnt            IN     stg_gsmac_transaction.act_ff_rprnt%TYPE,
    inActErr1               IN     stg_gsmac_transaction.act_err1%TYPE,
    inActErr2               IN     stg_gsmac_transaction.act_err2%TYPE,
    inActErr3               IN     stg_gsmac_transaction.act_err3%TYPE,
    inActLastUser           IN     stg_gsmac_transaction.act_last_user%TYPE,
    inActLastAction         IN     stg_gsmac_transaction.act_last_action%TYPE,
    inActLastDt             IN     stg_gsmac_transaction.act_last_dt%TYPE,
    inActLastTm             IN     stg_gsmac_transaction.act_last_tm%TYPE,
    inActLastPgm            IN     stg_gsmac_transaction.act_last_pgm%TYPE,
    inActLastTran           IN     stg_gsmac_transaction.act_last_tran%TYPE,
    inActSysDt              IN     stg_gsmac_transaction.act_sys_dt%TYPE,
    inActSysTm              IN     stg_gsmac_transaction.act_sys_tm%TYPE,
    inActBearShs            IN     stg_gsmac_transaction.act_bear_shs%TYPE,
    inActShsRtn             IN     stg_gsmac_transaction.act_shs_rtn%TYPE,
    inActRetShsId           IN     stg_gsmac_transaction.act_ret_shs_id%TYPE,
    inActRetShsSeq          IN     stg_gsmac_transaction.act_ret_shs_seq%TYPE,
    inActXferId             IN     stg_gsmac_transaction.act_xfer_id%TYPE,
    inActSubValDt           IN     stg_gsmac_transaction.act_sub_val_dt%TYPE,
    inActSsbValDt           IN     stg_gsmac_transaction.act_ssb_val_dt%TYPE,
    inActContCshDt          IN     stg_gsmac_transaction.act_cont_csh_dt%TYPE,
    inActContCshTm          IN     stg_gsmac_transaction.act_cont_csh_tm%TYPE,
    inActIbsSeq             IN     stg_gsmac_transaction.act_ibs_seq%TYPE,
    inActContStlFl          IN     stg_gsmac_transaction.act_cont_stl_fl%TYPE,
    inActCashFp             IN     stg_gsmac_transaction.act_cash_fp%TYPE,
    inActOmniId             IN     stg_gsmac_transaction.act_omni_id%TYPE,
    inActOmniSeq            IN     stg_gsmac_transaction.act_omni_seq%TYPE,
    inActOmniShs            IN     stg_gsmac_transaction.act_omni_shs%TYPE,
    inActOmniNet            IN     stg_gsmac_transaction.act_omni_net%TYPE,
    inActTranLvl            IN     stg_gsmac_transaction.act_tran_lvl%TYPE,
    inActSysDttm            IN     stg_gsmac_transaction.act_sys_dttm%TYPE,
    inActDdaValdt           IN     stg_gsmac_transaction.act_dda_valdt%TYPE,
    inActErrors             IN     stg_gsmac_transaction.act_errors%TYPE,
    inActIbsAcct            IN     stg_gsmac_transaction.act_ibs_acct%TYPE,
    inActIbsInst            IN     stg_gsmac_transaction.act_ibs_inst%TYPE,
    inActIbsRegAcct         IN     stg_gsmac_transaction.act_ibs_reg_acct%TYPE,
    inActIbsRegInst         IN     stg_gsmac_transaction.act_ibs_reg_inst%TYPE,
    inActSubRefno           IN     stg_gsmac_transaction.act_sub_refno%TYPE,
    inActExecBicOr          IN     stg_gsmac_transaction.act_exec_bic_or%TYPE,
    inActClrngBicOr         IN     stg_gsmac_transaction.act_clrng_bic_or%TYPE,
    inActSafeAcct           IN     stg_gsmac_transaction.act_safe_acct%TYPE,
    inActIsin               IN     stg_gsmac_transaction.act_isin%TYPE,
    inActFundCtry           IN     stg_gsmac_transaction.act_fund_ctry%TYPE,
    inActTrdInstCrt         IN     stg_gsmac_transaction.act_trd_inst_crt%TYPE,
    inActCurrInd            IN     stg_gsmac_transaction.act_curr_ind%TYPE,
    inActCurrentInd         IN     stg_gsmac_transaction.act_current_ind%TYPE,
    inActMt54xTyp           IN     stg_gsmac_transaction.act_mt54x_typ%TYPE,
    inActMsgSrc             IN     stg_gsmac_transaction.act_msg_src%TYPE,
    inActAddtlNarr          IN     stg_gsmac_transaction.act_addtl_narr%TYPE,
    inActCurrSeq            IN     stg_gsmac_transaction.act_curr_seq%TYPE,
    inActBlkLink            IN     stg_gsmac_transaction.act_blk_link%TYPE,
    inActAllocsVsMoney      IN     stg_gsmac_transaction.act_allocs_vs_money%TYPE,
    inActCsdFundDt          IN     stg_gsmac_transaction.act_csd_fund_dt%TYPE,
    inActCsdRevDt           IN     stg_gsmac_transaction.act_csd_rev_dt%TYPE,
    inActBktolExc           IN     stg_gsmac_transaction.act_bktol_exc%TYPE,
    inActStampDuty          IN     stg_gsmac_transaction.act_stamp_duty%TYPE,
    inActRshsLinked         IN     stg_gsmac_transaction.act_rshs_linked%TYPE,
    inActOrderNum           IN     stg_gsmac_transaction.act_order_num%TYPE,
    inActUptRptInd          IN     stg_gsmac_transaction.act_upt_rpt_ind%TYPE,
    inActShortInd           IN     stg_gsmac_transaction.act_short_ind%TYPE,
    inF72                   IN     stg_gsmac_transaction.f72%TYPE,
    inF77b001               IN     stg_gsmac_transaction.f77b_001%TYPE,
    inF77b002               IN     stg_gsmac_transaction.f77b_002%TYPE,
    inF77d001               IN     stg_gsmac_transaction.f77d_001%TYPE,
    inF77d002               IN     stg_gsmac_transaction.f77d_002%TYPE,
    inF85c                  IN     stg_gsmac_transaction.f85c%TYPE,
    inF85d                  IN     stg_gsmac_transaction.f85d%TYPE,
    inF87a                  IN     stg_gsmac_transaction.f87a%TYPE,
    inF87d                  IN     stg_gsmac_transaction.f87d%TYPE,
    inF88c                  IN     stg_gsmac_transaction.f88c%TYPE,
    inF88d                  IN     stg_gsmac_transaction.f88d%TYPE,
    inF33v                  IN     stg_gsmac_transaction.f33v%TYPE,
    inS901                  IN     stg_gsmac_transaction.s901%TYPE,
    inS902                  IN     stg_gsmac_transaction.s902%TYPE,
    inS903                  IN     stg_gsmac_transaction.s903%TYPE,
    inS904                  IN     stg_gsmac_transaction.s904%TYPE,
    inS905                  IN     stg_gsmac_transaction.s905%TYPE,
    inS906                  IN     stg_gsmac_transaction.s906%TYPE,
    inS907                  IN     stg_gsmac_transaction.s907%TYPE,
    inS908                  IN     stg_gsmac_transaction.s908%TYPE,
    inS909                  IN     stg_gsmac_transaction.s909%TYPE,
    inS90x                  IN     stg_gsmac_transaction.s90x%TYPE,
    inF25d                  IN     stg_gsmac_transaction.f25d%TYPE,
    inF24b                  IN     stg_gsmac_transaction.f24b%TYPE)

IS

BEGIN

   /* Insert flattened GSMAC Transaction message */
   INSERT INTO stg_gsmac_transaction
     (msg_id,
      f20,
      topic,
      version,
      mt599_sequence,
      f28,
      f83a,
      f67a,
      f98a,
      f99a,
      d99,
      f35b,
      f35a,
      f66a,
      f30,
      f34a,
      f18a,
      ref_cusip,
      ref_ticker,
      ref_inv_type,
      ref_inv_type_desc,
      ref_issue_name,
      ref_issue_desc,
      ref_rate,
      ref_mat_dt,
      ref_asst_cls,
      ref_nra_txctry,
      ref_gvt_pool_no,
      ref_old_cusip,
      ref_jgb_sw,
      ref_rednm_sw,
      ref_euro_hist_sw,
      ref_var_rt_sw,
      act_fund,
      act_cl_ref,
      act_cusip,
      act_mat_dt,
      act_rate,
      act_sec_typ,
      act_iss_dt,
      act_trd_id,
      act_trd_id_seq,
      act_tran_type,
      act_tran_qual,
      act_trd_dt,
      act_csd,
      act_cont_shs,
      act_orig_face,
      act_cont_amt,
      act_curr_cd,
      act_pmt_meth,
      act_exec_brk,
      act_clrng_brk,
      act_clrng_bnk,
      act_rel_trd_id,
      act_rel_trd_id_seq,
      act_corp_actn_id,
      act_setl_loc,
      act_setl_acct,
      act_secs_acct,
      act_set_loc_ref,
      act_full_part,
      act_stl_lvl,
      act_actual_shs,
      act_net_amt,
      act_comm_shs,
      act_actual_setl_dt,
      act_sys_setl_dt,
      act_tran_id_typ,
      act_tran_grp_id,
      act_rel_cash_id,
      act_rel_cash_seq,
      act_rel_cash_lnk,
      act_btch_dt,
      act_btch_cd,
      act_btch_stat,
      act_next_seq,
      act_euclid_typ,
      act_euclid_pri,
      act_sw_msg_pri,
      act_sw_msg_stat,
      act_reg_req,
      act_nxt_dest,
      act_event_typ,
      act_rpt_dt,
      act_iscu_rpt_dt,
      act_eta_dt,
      act_fail_rsn,
      act_rsn,
      act_pshs_rsn,
      act_fail_dt,
      act_reg_shs,
      act_unreg_shs,
      act_unreg_for,
      act_reg_aff_avl,
      act_trddt_upd,
      act_rec_del,
      act_stat,
      act_comment,
      act_ff_prt_dt,
      act_ff_domn,
      act_ff_seq,
      act_ff_rprnt,
      act_err1,
      act_err2,
      act_err3,
      act_last_user,
      act_last_action,
      act_last_dt,
      act_last_tm,
      act_last_pgm,
      act_last_tran,
      act_sys_dt,
      act_sys_tm,
      act_bear_shs,
      act_shs_rtn,
      act_ret_shs_id,
      act_ret_shs_seq,
      act_xfer_id,
      act_sub_val_dt,
      act_ssb_val_dt,
      act_cont_csh_dt,
      act_cont_csh_tm,
      act_ibs_seq,
      act_cont_stl_fl,
      act_cash_fp,
      act_omni_id,
      act_omni_seq,
      act_omni_shs,
      act_omni_net,
      act_tran_lvl,
      act_sys_dttm,
      act_dda_valdt,
      act_errors,
      act_ibs_acct,
      act_ibs_inst,
      act_ibs_reg_acct,
      act_ibs_reg_inst,
      act_sub_refno,
      act_exec_bic_or,
      act_clrng_bic_or,
      act_safe_acct,
      act_isin,
      act_fund_ctry,
      act_trd_inst_crt,
      act_curr_ind,
      act_current_ind,
      act_mt54x_typ,
      act_msg_src,
      act_addtl_narr,
      act_curr_seq,
      act_blk_link,
      act_allocs_vs_money,
      act_csd_fund_dt,
      act_csd_rev_dt,
      act_bktol_exc,
      act_stamp_duty,
      act_rshs_linked,
      act_order_num,
      act_upt_rpt_ind,
      act_short_ind,
      f72,
      f77b_001,
      f77b_002,
      f77d_001,
      f77d_002,
      f85c,
      f85d,
      f87a,
      f87d,
      f88c,
      f88d,
      f33v,
      s901,
      s902,
      s903,
      s904,
      s905,
      s906,
      s907,
      s908,
      s909,
      s90x,
      f25d,
      f24b)
   VALUES
     (inMsgId,
      inF20,
      inTopic,
      inVersion,
      inMt599Sequence,
      inF28,
      inF83a,
      inF67a,
      inF98a,
      inF99a,
      inD99,
      inF35b,
      inF35a,
      inF66a,
      inF30,
      inF34a,
      inF18a,
      inRefCusip,
      inRefTicker,
      inRefInvType,
      inRefInvTypeDesc,
      inRefIssueName,
      inRefIssueDesc,
      inRefRate,
      inRefMatDt,
      inRefAsstCls,
      inRefNraTxctry,
      inRefGvtPoolNo,
      inRefOldCusip,
      inRefJgbSw,
      inRefRednmSw,
      inRefEuroHistSw,
      inRefVarRtSw,
      inActFund,
      inActClRef,
      inActCusip,
      inActMatDt,
      inActRate,
      inActSecTyp,
      inActIssDt,
      inActTrdId,
      inActTrdIdSeq,
      inActTranType,
      inActTranQual,
      inActTrdDt,
      inActCsd,
      inActContShs,
      inActOrigFace,
      inActContAmt,
      inActCurrCd,
      inActPmtMeth,
      inActExecBrk,
      inActClrngBrk,
      inActClrngBnk,
      inActRelTrdId,
      inActRelTrdIdSeq,
      inActCorpActnId,
      inActSetlLoc,
      inActSetlAcct,
      inActSecsAcct,
      inActSetLocRef,
      inActFullPart,
      inActStlLvl,
      inActActualShs,
      inActNetAmt,
      inActCommShs,
      inActActualSetlDt,
      inActSysSetlDt,
      inActTranIdTyp,
      inActTranGrpId,
      inActRelCashId,
      inActRelCashSeq,
      inActRelCashLnk,
      inActBtchDt,
      inActBtchCd,
      inActBtchStat,
      inActNextSeq,
      inActEuclidTyp,
      inActEuclidPri,
      inActSwMsgPri,
      inActSwMsgStat,
      inActRegReq,
      inActNxtDest,
      inActEventTyp,
      inActRptDt,
      inActIscuRptDt,
      inActEtaDt,
      inActFailRsn,
      inActRsn,
      inActPshsRsn,
      inActFailDt,
      inActRegShs,
      inActUnregShs,
      inActUnregFor,
      inActRegAffAvl,
      inActTrddtUpd,
      inActRecDel,
      inActStat,
      inActComment,
      inActFfPrtDt,
      inActFfDomn,
      inActFfSeq,
      inActFfRprnt,
      inActErr1,
      inActErr2,
      inActErr3,
      inActLastUser,
      inActLastAction,
      inActLastDt,
      inActLastTm,
      inActLastPgm,
      inActLastTran,
      inActSysDt,
      inActSysTm,
      inActBearShs,
      inActShsRtn,
      inActRetShsId,
      inActRetShsSeq,
      inActXferId,
      inActSubValDt,
      inActSsbValDt,
      inActContCshDt,
      inActContCshTm,
      inActIbsSeq,
      inActContStlFl,
      inActCashFp,
      inActOmniId,
      inActOmniSeq,
      inActOmniShs,
      inActOmniNet,
      inActTranLvl,
      inActSysDttm,
      inActDdaValdt,
      inActErrors,
      inActIbsAcct,
      inActIbsInst,
      inActIbsRegAcct,
      inActIbsRegInst,
      inActSubRefno,
      inActExecBicOr,
      inActClrngBicOr,
      inActSafeAcct,
      inActIsin,
      inActFundCtry,
      inActTrdInstCrt,
      inActCurrInd,
      inActCurrentInd,
      inActMt54xTyp,
      inActMsgSrc,
      inActAddtlNarr,
      inActCurrSeq,
      inActBlkLink,
      inActAllocsVsMoney,
      inActCsdFundDt,
      inActCsdRevDt,
      inActBktolExc,
      inActStampDuty,
      inActRshsLinked,
      inActOrderNum,
      inActUptRptInd,
      inActShortInd,
      inF72,
      inF77b001,
      inF77b002,
      inF77d001,
      inF77d002,
      inF85c,
      inF85d,
      inF87a,
      inF87d,
      inF88c,
      inF88d,
      inF33v,
      inS901,
      inS902,
      inS903,
      inS904,
      inS905,
      inS906,
      inS907,
      inS908,
      inS909,
      inS90x,
      inF25d,
      inF24b);

EXCEPTION
   WHEN OTHERS
      THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_ins_StgGsmacTransaction **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_ins_StgGsmacTransaction;


PROCEDURE sp_upd_MessageCvw
   (inMsgId                     IN     message_cvw.msg_id%TYPE,
    inMsgState                  IN     message_cvw.msg_state%TYPE)

IS

BEGIN

   UPDATE message_cvw
   SET    msg_state = inMsgState,
          UPDT_DTTM = CURRENT_TIMESTAMP,
          UPDT_LGN  = USER
   WHERE  msg_id = inMsgId;

EXCEPTION
   WHEN  OTHERS
     THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_upd_MessageCvw **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_upd_MessageCvw;



PROCEDURE sp_gsmac_position_publish
   (inPositionSeq	                  IN     gsmac_position_publisher.POSITION_SEQ%TYPE,
	inPosFund                         IN     gsmac_position_publisher.POS_FUND%TYPE,
	inPosSetlLoc                      IN     gsmac_position_publisher.POS_SETL_LOC%TYPE,
	inPosCusip                        IN     gsmac_position_publisher.POS_CUSIP%TYPE,
	inActTrdId                        IN     gsmac_position_publisher.ACT_TRD_ID%TYPE,
	inPosSetlAcct                     IN     gsmac_position_publisher.ACT_SETL_ACCT%TYPE,
	inSecurityId                      IN     gsmac_position_publisher.SECURITY_ID%TYPE,
	inPosTotal                        IN     gsmac_position_publisher.POS_TOTAL%TYPE,
	inSourceCorrId                    IN     gsmac_position_publisher.SOURCE_CORR_ID%TYPE)


IS

BEGIN

     INSERT INTO gsmac_position_publisher
               (position_seq,
				pos_fund,
				pos_setl_loc,
				pos_cusip,
				act_trd_id,
				act_setl_acct,
				security_id,
				pos_total,
				pos_asof_date,
				source_corr_id,
				lastmodsignon,
				lastmoddatetime)
       VALUES
              (	inPositionSeq,
				inPosFund,     
				inPosSetlLoc,   
				inPosCusip,     
				inActTrdId,     
				inPosSetlAcct,  
				inSecurityId,  
				inPosTotal,
				trunc(CURRENT_DATE),			   
				inSourceCorrId,               
				USER,
				CURRENT_TIMESTAMP);

EXCEPTION
   WHEN OTHERS
      THEN
         DBMS_OUTPUT.PUT_LINE('Exception Handler encountered!');
         DBMS_OUTPUT.PUT_LINE('** pkg_custody.sp_mrg_SmacPosition **');
         DBMS_OUTPUT.PUT_LINE(sqlcode);
         DBMS_OUTPUT.PUT_LINE(sqlerrm);
         RAISE;

END sp_Gsmac_Position_Publish;

/*--------------------------------*/
/* ##### PROCEDURES :  End  ##### */
/*--------------------------------*/

END pkg_custody;
/
